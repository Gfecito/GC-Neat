(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    149463,       2820]
NotebookOptionsPosition[    145475,       2741]
NotebookOutlinePosition[    145870,       2757]
CellTagsIndexPosition[    145827,       2754]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["All model specifications", "Title",
 CellChangeTimes->{{3.88055740413876*^9, 3.880557412159724*^9}, {
  3.880557450477572*^9, 
  3.880557452076091*^9}},ExpressionUUID->"e37f6926-aed1-48b8-9893-\
6fbdcfd3ab58"],

Cell["\<\
Tous les modeles ont le m\[EHat]me volume de co\[UHat]t et la m\[EHat]me \
structure de 3 parties\
\>", "Text",
 CellChangeTimes->{{3.88055745494741*^9, 3.880557455979125*^9}, {
  3.880561563239107*^9, 
  3.8805615829913063`*^9}},ExpressionUUID->"652cfa43-8369-47ed-b30c-\
5d606b74c211"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"conv2d", "[", 
    RowBox[{"f_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"k", "-", "1"}], ")"}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"NetChain", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PaddingLayer", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"p", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"p", ",", "p"}], "}"}]}], "}"}], ",", 
          RowBox[{"Padding", "->", "\"\<Fixed\>\""}]}], "]"}], ",", 
        RowBox[{"ConvolutionLayer", "[", 
         RowBox[{"f", ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "k"}], "}"}]}], "]"}], ",", "Ramp"}], "}"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"conv2d", "[", "f_", "]"}], ":=", 
   RowBox[{"NetChain", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PaddingLayer", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"Padding", "->", "\"\<Fixed\>\""}]}], "]"}], ",", 
      RowBox[{"ConvolutionLayer", "[", 
       RowBox[{"f", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], "]"}], ",", "Ramp"}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"conv3d", "[", 
    RowBox[{"f_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"k", "-", "1"}], ")"}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"NetChain", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PaddingLayer", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"p", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"p", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"p", ",", "p"}], "}"}]}], "}"}], ",", 
          RowBox[{"Padding", "->", "\"\<Fixed\>\""}]}], "]"}], ",", 
        RowBox[{"ConvolutionLayer", "[", 
         RowBox[{"f", ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "k", ",", "k"}], "}"}]}], "]"}], ",", "Ramp"}], 
       "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"conv3d", "[", "f_", "]"}], ":=", 
   RowBox[{"NetChain", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PaddingLayer", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"Padding", "->", "\"\<Fixed\>\""}]}], "]"}], ",", 
      RowBox[{"ConvolutionLayer", "[", 
       RowBox[{"f", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "]"}], ",", "Ramp"}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"upconv3d", "[", "f_", "]"}], ":=", 
  RowBox[{"NetChain", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ResizeLayer", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Scaled", "[", "2", "]"}], ",", 
        RowBox[{"Scaled", "[", "2", "]"}], ",", 
        RowBox[{"Scaled", "[", "2", "]"}]}], "}"}], "]"}], ",", 
     RowBox[{"PaddingLayer", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"Padding", "->", "\"\<Fixed\>\""}]}], "]"}], ",", 
     RowBox[{"ConvolutionLayer", "[", 
      RowBox[{"f", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "]"}]}], "}"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.879341604102272*^9, 3.879341606923513*^9}, {
   3.8793416482042837`*^9, 3.8793417309464006`*^9}, {3.87934179688118*^9, 
   3.8793419019192047`*^9}, {3.879341963951344*^9, 3.879342312163074*^9}, {
   3.879342344437942*^9, 3.879342352231041*^9}, {3.879342419384132*^9, 
   3.87934253958526*^9}, {3.879342599153838*^9, 3.879342607487556*^9}, {
   3.879342854263424*^9, 3.879342945538087*^9}, {3.879343400089707*^9, 
   3.879343468337978*^9}, {3.879343501156274*^9, 3.879343602283358*^9}, 
   3.879611212915058*^9, {3.879684543855619*^9, 3.879684543993314*^9}, {
   3.880130389490707*^9, 3.880130485263706*^9}, {3.880398879162475*^9, 
   3.8803989980071507`*^9}, {3.88040273703226*^9, 3.8804027661733303`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"cb752701-4dd3-4b12-82d2-b28f89840ba2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"replicateLeft", "[", "maxDisp_", "]"}], ":=", 
  RowBox[{"NetChain", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ReplicateLayer", "[", 
      RowBox[{"maxDisp", "+", "1"}], "]"}], ",", 
     RowBox[{"FunctionLayer", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}], "&"}], 
      "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotateRight", "[", 
   RowBox[{"{", 
    RowBox[{"channels_", ",", "rows_", ",", "cols_", ",", "maxDisp_"}], "}"}],
    "]"}], ":=", 
  RowBox[{"NetGraph", "[", 
   RowBox[{
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"PaddingLayer", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"maxDisp", ",", "0"}], "}"}]}], "}"}], ",", 
         "\"\<Fixed\>\""}], "]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FunctionLayer", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "All", ",", 
              RowBox[{
               RowBox[{"1", "-", "d", "+", "maxDisp"}], ";;", 
               RowBox[{"cols", "-", "d", "+", "maxDisp"}]}]}], "]"}], "]"}], 
           "}"}], "&"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"d", ",", "0", ",", "maxDisp"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"CatenateLayer", "[", "]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"FunctionLayer", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}], 
         "&"}], "]"}], "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NetPort", "[", "\"\<Input\>\"", "]"}], "\[Rule]", 
      RowBox[{"1", "\[Rule]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"d", ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "2", ",", 
            RowBox[{"maxDisp", "+", "2"}]}], "}"}]}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"maxDisp", "+", "3"}], "\[Rule]", 
         RowBox[{
          RowBox[{"maxDisp", "+", "4"}], "\[Rule]", 
          RowBox[{"NetPort", "[", "\"\<Output\>\"", "]"}]}]}]}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"\"\<Input\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"channels", ",", "rows", ",", "cols"}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"featuresToCostVolume", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"features_", ",", "height_", ",", "width_"}], "}"}], ",", 
     "maxDisp_"}], "]"}], ":=", 
   RowBox[{"NetGraph", "@", 
    RowBox[{"FunctionLayer", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"leftVol", ",", "rightVol"}], "}"}], ",", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"leftVol", "=", 
            RowBox[{
             RowBox[{"replicateLeft", "[", "maxDisp", "]"}], "[", "#fLeft", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rightVol", "=", 
            RowBox[{
             RowBox[{"rotateRight", "[", 
              RowBox[{"{", 
               RowBox[{
               "features", ",", "height", ",", "width", ",", "maxDisp"}], 
               "}"}], "]"}], "[", "#fRight", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{"\"\<Output\>\"", "->", 
             RowBox[{"Join", "[", 
              RowBox[{"leftVol", ",", "rightVol"}], "]"}]}], "|>"}]}], 
          "\[IndentingNewLine]", ")"}]}], "]"}], "&"}], ",", " ", 
      RowBox[{"\"\<fLeft\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"features", ",", "height", ",", "width"}], "}"}]}], ",", 
      RowBox[{"\"\<fRight\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"features", ",", "height", ",", "width"}], "}"}]}]}], 
     "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.879349028849433*^9, 3.879349032753893*^9}, {
  3.879349167028551*^9, 3.8793492069756613`*^9}, {3.8793492486444607`*^9, 
  3.879349480559718*^9}, {3.8793495360791693`*^9, 3.8793495577600594`*^9}, {
  3.879352610637146*^9, 3.8793526133785973`*^9}, {3.8793530388251953`*^9, 
  3.879353038984963*^9}, {3.879353447604671*^9, 3.879353477484305*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"efa95fbf-53d4-4a04-950f-ce5afc42869a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trainableGCNet", "[", "params_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "featureEncoderLayer", ",", "features2CostLayer", ",", 
      "stereoMatchLayer"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", 
        RowBox[{"-", 
         RowBox[{"init", "--"}]}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"featureEncoderLayer", "=", 
       RowBox[{"featureEncoder", "[", 
        RowBox[{"params", "[", "\"\<features\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"features2CostLayer", "=", 
       RowBox[{"featuresToCostVolume", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"params", "[", "\"\<features\>\"", "]"}], ",", 
           RowBox[{"params", "[", "\"\<inputHeight\>\"", "]"}], ",", 
           RowBox[{"params", "[", "\"\<inputWidth\>\"", "]"}]}], "}"}], ",", 
         RowBox[{"params", "[", "\"\<maxDisp\>\"", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"stereoMatchLayer", "=", 
       RowBox[{"stereoMatcher", "[", 
        RowBox[{"params", "[", "\"\<features\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"--", 
         RowBox[{"-", 
          RowBox[{"forward", "--"}]}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"NetGraph", "@", 
       RowBox[{"FunctionLayer", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "fLeft", ",", "fRight", ",", "costVol", ",", "match", ",", 
              "probabilities", ",", "range", ",", "prediction", ",", "loss"}],
              "}"}], ",", 
            RowBox[{"(", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"fLeft", "=", 
               RowBox[{"featureEncoderLayer", "[", "#iLeft", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"fRight", "=", 
               RowBox[{"featureEncoderLayer", "[", "#iRight", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"costVol", "=", 
               RowBox[{"features2CostLayer", "[", 
                RowBox[{"<|", 
                 RowBox[{
                  RowBox[{"\"\<fLeft\>\"", "->", "fLeft"}], ",", 
                  RowBox[{"\"\<fRight\>\"", "->", "fRight"}]}], "|>"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"match", "=", 
               RowBox[{"stereoMatchLayer", "[", "costVol", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"probabilities", "=", 
               RowBox[{
                RowBox[{"SoftmaxLayer", "[", 
                 RowBox[{"-", "1"}], "]"}], "[", "match", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"range", "=", 
               RowBox[{
                RowBox[{"NetArrayLayer", "[", 
                 RowBox[{
                  RowBox[{"\"\<Array\>\"", "->", 
                   RowBox[{"Range", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"params", "[", "\"\<maxDisp\>\"", "]"}]}], 
                    "]"}]}], ",", 
                  RowBox[{"LearningRateMultipliers", "->", "0"}]}], "]"}], 
                "[", "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"prediction", "=", 
               RowBox[{"probabilities", ".", "range"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"loss", "=", 
               RowBox[{
                RowBox[{"MeanAbsoluteLossLayer", "[", "]"}], "[", 
                RowBox[{"<|", 
                 RowBox[{
                  RowBox[{"\"\<Input\>\"", "->", "prediction"}], ",", 
                  RowBox[{"\"\<Target\>\"", "->", "#dispLeft"}]}], "|>"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<Output\>\"", "->", "prediction"}], ",", 
                RowBox[{"\"\<Loss\>\"", "->", "loss"}]}], "|>"}]}], 
             "\[IndentingNewLine]", ")"}]}], "]"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<iLeft\>\"", "->", 
          RowBox[{"NetEncoder", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<Image\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"params", "[", "\"\<inputWidth\>\"", "]"}], ",", 
               RowBox[{"params", "[", "\"\<inputHeight\>\"", "]"}]}], "}"}], 
             ",", "\"\<RGB\>\""}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<iRight\>\"", "->", 
          RowBox[{"NetEncoder", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<Image\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"params", "[", "\"\<inputWidth\>\"", "]"}], ",", 
               RowBox[{"params", "[", "\"\<inputHeight\>\"", "]"}]}], "}"}], 
             ",", "\"\<RGB\>\""}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<dispLeft\>\"", "->", 
          RowBox[{"NetEncoder", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<Image\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"params", "[", "\"\<inputWidth\>\"", "]"}], ",", 
               RowBox[{"params", "[", "\"\<inputHeight\>\"", "]"}]}], "}"}], 
             ",", "\"\<Grayscale\>\""}], "}"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8642971560753317`*^9, 3.864297321668839*^9}, {
   3.864297426054166*^9, 3.8642975334218273`*^9}, {3.8642976894979362`*^9, 
   3.864297705303082*^9}, {3.864297782550582*^9, 3.8642978749095097`*^9}, {
   3.864297913244063*^9, 3.864297975081922*^9}, {3.8642980128920183`*^9, 
   3.864298046923254*^9}, {3.864298092051548*^9, 3.864298163500557*^9}, {
   3.8642982658666773`*^9, 3.86429833326086*^9}, {3.864298376847731*^9, 
   3.864298378334578*^9}, {3.8642984656987677`*^9, 3.864298470470859*^9}, {
   3.864298533185711*^9, 3.864298536372733*^9}, 3.864298717939622*^9, {
   3.8644619391236486`*^9, 3.864461954631907*^9}, {3.864908182908127*^9, 
   3.864908187730322*^9}, {3.864908346792715*^9, 3.8649084144707613`*^9}, {
   3.864909270192791*^9, 3.8649093301330357`*^9}, 3.864909441495468*^9, {
   3.864909473892476*^9, 3.864909484802217*^9}, {3.864982633949589*^9, 
   3.864982730901598*^9}, {3.864984846250566*^9, 3.8649848519510098`*^9}, {
   3.864987650400429*^9, 3.864987656309813*^9}, {3.8649886260817204`*^9, 
   3.864988626252521*^9}, {3.8649899282317667`*^9, 3.864989980472209*^9}, {
   3.864990084179488*^9, 3.864990094586014*^9}, {3.86499150454633*^9, 
   3.8649916024161654`*^9}, {3.86499168920679*^9, 3.864991726256454*^9}, 
   3.864991807308263*^9, {3.8649918515670433`*^9, 3.864991906083755*^9}, {
   3.8649919928783484`*^9, 3.86499199615205*^9}, {3.864992027091736*^9, 
   3.864992039692363*^9}, {3.864992072138052*^9, 3.864992080229616*^9}, {
   3.864992120782631*^9, 3.8649921347611*^9}, {3.864993522537169*^9, 
   3.864993536134345*^9}, {3.864993572586138*^9, 3.8649936401112013`*^9}, {
   3.864998422802161*^9, 3.864998519739326*^9}, {3.864998579983699*^9, 
   3.864998588558549*^9}, {3.864998641566579*^9, 3.864998657990224*^9}, 
   3.864998728351574*^9, {3.864998786090961*^9, 3.8649987925450087`*^9}, {
   3.8649994641051483`*^9, 3.864999474271853*^9}, {3.8649996219875917`*^9, 
   3.864999633223666*^9}, {3.865000405207079*^9, 3.8650004374683027`*^9}, {
   3.865008968891549*^9, 3.865008978352496*^9}, 3.8650090259384727`*^9, {
   3.8653456769994307`*^9, 3.865345679951064*^9}, {3.865346675601695*^9, 
   3.865346675954549*^9}, 3.8653475825905457`*^9, {3.865422481075314*^9, 
   3.8654224940006647`*^9}, {3.865434141417286*^9, 3.865434229358629*^9}, {
   3.865434295697486*^9, 3.865434337444336*^9}, {3.865437587711506*^9, 
   3.865437592976727*^9}, 3.865449390302051*^9, {3.8655124102338543`*^9, 
   3.86551241033257*^9}, {3.865519185155155*^9, 3.865519187190467*^9}, {
   3.8655200397088947`*^9, 3.8655200516761217`*^9}, {3.865521133391367*^9, 
   3.865521134812397*^9}, {3.865524829459621*^9, 3.86552483280748*^9}, {
   3.8655296221639214`*^9, 3.8655297065067663`*^9}, {3.865529761631893*^9, 
   3.8655297617722197`*^9}, {3.865534840987632*^9, 3.865534946698985*^9}, {
   3.865535019773446*^9, 3.865535029713653*^9}, {3.865535914461954*^9, 
   3.86553592809407*^9}, {3.8655359616757307`*^9, 3.865536093482892*^9}, 
   3.8655362673148727`*^9, 3.865584001011497*^9, {3.865584082414337*^9, 
   3.865584089301093*^9}, {3.865584197666383*^9, 3.865584199938727*^9}, {
   3.865584253315632*^9, 3.8655842708628263`*^9}, {3.865584859898327*^9, 
   3.865584860650134*^9}, {3.865585075271306*^9, 3.865585126574689*^9}, {
   3.865585302081812*^9, 3.865585309319119*^9}, 3.865586282363821*^9, {
   3.865586980421566*^9, 3.865586995302731*^9}, {3.8655870593161993`*^9, 
   3.8655871410394363`*^9}, {3.86558770697703*^9, 3.865587715982068*^9}, {
   3.865588209915936*^9, 3.865588212026025*^9}, {3.865588417539843*^9, 
   3.8655884239417553`*^9}, 3.865589646214896*^9, {3.865592893992288*^9, 
   3.8655929028577757`*^9}, {3.8655930011045322`*^9, 3.865593042232716*^9}, {
   3.865593659999056*^9, 3.865593664199079*^9}, {3.865593705653048*^9, 
   3.8655937111621847`*^9}, {3.865593895918704*^9, 3.86559392439946*^9}, {
   3.865602349792571*^9, 3.865602361818635*^9}, 3.8656025912050943`*^9, {
   3.865605022657424*^9, 3.865605022809877*^9}, {3.86601704922449*^9, 
   3.866017049660884*^9}, {3.866018660246491*^9, 3.866018664642766*^9}, {
   3.866021273124432*^9, 3.8660212761231403`*^9}, 3.866021448646379*^9, {
   3.866021703996364*^9, 3.8660217070564613`*^9}, 3.866035772949377*^9, {
   3.866036804772846*^9, 3.86603682868575*^9}, 3.866037447340913*^9, {
   3.866037532094297*^9, 3.866037536044004*^9}, {3.866037627450358*^9, 
   3.866037628947542*^9}, {3.866037746521656*^9, 3.8660377478886557`*^9}, 
   3.866037871418632*^9, {3.866039576380975*^9, 3.8660395765003443`*^9}, {
   3.8660396940686073`*^9, 3.866039716648156*^9}, {3.866119367460462*^9, 
   3.866119454724841*^9}, {3.866119638316676*^9, 3.866119701799397*^9}, {
   3.866119846871057*^9, 3.8661199131199017`*^9}, {3.866123968433622*^9, 
   3.8661240041978703`*^9}, {3.86612685427917*^9, 3.866126900692857*^9}, {
   3.866190313724703*^9, 3.866190326950613*^9}, {3.8661908152640533`*^9, 
   3.866190836006069*^9}, {3.866209676180365*^9, 3.866209722773699*^9}, {
   3.8662097569929113`*^9, 3.8662098474946136`*^9}, {3.8662113525688143`*^9, 
   3.866211357157461*^9}, {3.866212614872776*^9, 3.866212620172016*^9}, {
   3.866215014068651*^9, 3.866215041549499*^9}, {3.866215793841186*^9, 
   3.86621580029358*^9}, {3.8662167310113077`*^9, 3.8662167352958393`*^9}, {
   3.8662232717467823`*^9, 3.866223272907613*^9}, {3.86622355089727*^9, 
   3.866223552015295*^9}, {3.86622465246177*^9, 3.8662246541027603`*^9}, {
   3.8662268834861727`*^9, 3.866226914600793*^9}, {3.866227020875413*^9, 
   3.8662270222624407`*^9}, 3.866277544728778*^9, 3.866277726237278*^9, {
   3.866291018769141*^9, 3.866291030546069*^9}, {3.866291188875318*^9, 
   3.86629119457896*^9}, {3.8662912980543423`*^9, 3.8662913102430143`*^9}, 
   3.86673637168119*^9, {3.866737031363192*^9, 3.866737034737979*^9}, {
   3.866737272116262*^9, 3.866737286794602*^9}, {3.8667373359439507`*^9, 
   3.866737337648261*^9}, {3.867346799424296*^9, 3.867346799753326*^9}, 
   3.8719952654337387`*^9, {3.8720231608226757`*^9, 3.872023160915311*^9}, {
   3.872023270376236*^9, 3.872023277907228*^9}, 3.8720688597713223`*^9, {
   3.872069237944333*^9, 3.872069238674307*^9}, {3.872069274263637*^9, 
   3.872069283848652*^9}, {3.872153086591311*^9, 3.8721530979461517`*^9}, {
   3.874522980759087*^9, 3.874523006574242*^9}, {3.874584422961721*^9, 
   3.874584423441265*^9}, 3.8746663002384567`*^9, 3.8752785889827137`*^9, {
   3.878645868060483*^9, 3.878645875990556*^9}, {3.8786459301132727`*^9, 
   3.878645970194397*^9}, {3.878646075507066*^9, 3.878646075557591*^9}, 
   3.878651033653851*^9, 3.878651145132681*^9, {3.878651201506363*^9, 
   3.8786512235982237`*^9}, {3.878651259782247*^9, 3.8786513044566402`*^9}, 
   3.878653211269293*^9, {3.878654826464817*^9, 3.878654869232605*^9}, {
   3.878654918537451*^9, 3.87865494410341*^9}, {3.878655999568246*^9, 
   3.8786560002290173`*^9}, {3.878667722209536*^9, 3.878667722378937*^9}, {
   3.8787260650943604`*^9, 3.878726065898878*^9}, {3.878727985858926*^9, 
   3.8787279957746162`*^9}, 3.878728071415188*^9, {3.878728624140645*^9, 
   3.8787286256610613`*^9}, {3.8787783663461227`*^9, 
   3.8787783688399343`*^9}, {3.878829311503002*^9, 3.87882931795356*^9}, 
   3.878833956388493*^9, 3.878836212194078*^9, {3.878836263971336*^9, 
   3.878836302142728*^9}, {3.8788364055521917`*^9, 3.8788364075089903`*^9}, {
   3.87891232036259*^9, 3.87891233577169*^9}, {3.878919696205223*^9, 
   3.878919716662218*^9}, {3.878919765451899*^9, 3.8789197698838987`*^9}, {
   3.878919936731941*^9, 3.878919940095903*^9}, {3.878938193101869*^9, 
   3.878938194617077*^9}, {3.8792454558948517`*^9, 3.8792454565745487`*^9}, {
   3.879245548407476*^9, 3.879245570628809*^9}, {3.879245618245541*^9, 
   3.879245620704595*^9}, {3.8792459532325706`*^9, 3.8792459536216307`*^9}, {
   3.879246502863142*^9, 3.879246505459577*^9}, {3.879246991467431*^9, 
   3.879246994361895*^9}, {3.879250705052494*^9, 3.8792507331966143`*^9}, {
   3.879251324620749*^9, 3.879251340714656*^9}, {3.879251869743888*^9, 
   3.8792519094315987`*^9}, {3.879251983182148*^9, 3.879252015491468*^9}, {
   3.879254061633246*^9, 3.879254064772154*^9}, {3.879254989543605*^9, 
   3.879254992974765*^9}, {3.879255111607327*^9, 3.879255114187804*^9}, {
   3.87925570201363*^9, 3.879255705707993*^9}, {3.8792565676940107`*^9, 
   3.879256570255439*^9}, {3.879262175315426*^9, 3.879262178486652*^9}, {
   3.879262284948853*^9, 3.879262287950514*^9}, {3.879262318582295*^9, 
   3.879262320495059*^9}, {3.879331962343216*^9, 3.87933196728963*^9}, {
   3.879334717545423*^9, 3.879334721777145*^9}, {3.879341285232527*^9, 
   3.879341302376833*^9}, {3.879341338866713*^9, 3.879341432651805*^9}, {
   3.879341495486425*^9, 3.879341593557341*^9}, {3.879341640383976*^9, 
   3.879341641529262*^9}, {3.879341768090033*^9, 3.879341768701818*^9}, {
   3.879342581187037*^9, 3.879342627244748*^9}, 3.8793427165982656`*^9, {
   3.879343610485406*^9, 3.879343677207852*^9}, {3.879348989083943*^9, 
   3.879348990045081*^9}, 3.8793491475683804`*^9, {3.879352540540131*^9, 
   3.87935256789384*^9}, {3.8793526606007843`*^9, 3.879352750068582*^9}, {
   3.879352785846884*^9, 3.879352836284931*^9}, {3.879352868926*^9, 
   3.879352960093054*^9}, {3.8793530220908422`*^9, 3.879353096222539*^9}, {
   3.8793532278214607`*^9, 3.879353323854189*^9}, {3.8793534810852003`*^9, 
   3.879353696883471*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"30f2f15c-5be3-4200-a6c8-000ce99d9aa3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<inputHeight\>\"", "->", "68"}], ",", 
     RowBox[{"\"\<inputWidth\>\"", "->", "120"}], ",", 
     RowBox[{"\"\<features\>\"", "->", "4"}], ",", 
     RowBox[{"\"\<maxDisp\>\"", "->", "24"}]}], "|>"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.879341205101387*^9, 3.879341206430253*^9}, {
  3.879341305994741*^9, 3.8793413318804913`*^9}, {3.879352712926278*^9, 
  3.879352718729436*^9}, {3.8793527932493277`*^9, 3.879352802025671*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"8e2d27ca-11bb-4c92-9c1d-88b5502b96ad"],

Cell[BoxData[
 RowBox[{"trainableGCNet", "[", "params", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.87934255643985*^9, 3.8793425616815434`*^9}, {
   3.8793436830551853`*^9, 3.879343686544702*^9}, {3.879352773333596*^9, 
   3.87935277975179*^9}, 3.879352819982016*^9},
 CellLabel->"In[93]:=",ExpressionUUID->"7b7e33a1-1ef0-4d51-8094-2418b4a002a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"result", "=", 
   RowBox[{"NetTrain", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"trainableGCNet", "[", "params", "]"}], ",", 
     "\[IndentingNewLine]", "dataTrain", ",", "\[IndentingNewLine]", "All", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"ValidationSet", "\[Rule]", "dataValid"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"BatchSize", "\[Rule]", 
      RowBox[{"If", "[", 
       RowBox[{"ec2", ",", "16", ",", "2"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"MaxTrainingRounds", "\[Rule]", 
      RowBox[{"If", "[", 
       RowBox[{"ec2", ",", "128", ",", "2"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"LossFunction", "\[Rule]", "\"\<Loss\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<ADAM\>\"", ",", 
        RowBox[{"LearningRate", "\[Rule]", "0.001"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"TargetDevice", "\[Rule]", 
      RowBox[{"If", "[", 
       RowBox[{"ec2", ",", "\"\<GPU\>\"", ",", "\"\<CPU\>\""}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"WorkingPrecision", "\[Rule]", "\"\<Real32\>\""}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.811163737665946*^9, 3.81116383446729*^9}, {
   3.811163962430307*^9, 3.811163970224955*^9}, {3.811164302792*^9, 
   3.811164302928299*^9}, {3.811164714524312*^9, 3.811164723109048*^9}, {
   3.811164793675302*^9, 3.811164805966588*^9}, {3.8111648479456377`*^9, 
   3.811164848951977*^9}, {3.8111671656545477`*^9, 3.811167171329471*^9}, {
   3.8112458023276653`*^9, 3.8112458401086597`*^9}, {3.8112460082304573`*^9, 
   3.811246027950142*^9}, 3.8112461470838957`*^9, {3.811246442929923*^9, 
   3.811246491414433*^9}, {3.811249198416273*^9, 3.8112491985568333`*^9}, {
   3.811249315922929*^9, 3.811249316128089*^9}, {3.8112611218601847`*^9, 
   3.811261124074141*^9}, {3.811262841580852*^9, 3.8112628576514482`*^9}, {
   3.81126290557937*^9, 3.811262919706029*^9}, {3.811262961369068*^9, 
   3.8112629628637466`*^9}, {3.8112629955434923`*^9, 
   3.8112629966741323`*^9}, {3.811263710174115*^9, 3.811263744400473*^9}, {
   3.811263840273898*^9, 3.811263882982901*^9}, {3.8112651130034437`*^9, 
   3.811265113269217*^9}, 3.8112659338906517`*^9, {3.811266675872669*^9, 
   3.8112666827292747`*^9}, 3.8112667579318933`*^9, {3.811266808639874*^9, 
   3.811266808924706*^9}, {3.811266853232902*^9, 3.811266853399426*^9}, {
   3.8122835674131327`*^9, 3.812283572895401*^9}, {3.812283710418638*^9, 
   3.8122837251846952`*^9}, {3.812284133378434*^9, 3.812284136478663*^9}, {
   3.812292741801078*^9, 3.8122927432042923`*^9}, {3.812292809854702*^9, 
   3.812292812549164*^9}, {3.812292912073091*^9, 3.812292915972789*^9}, {
   3.8122930334786797`*^9, 3.812293035623172*^9}, {3.812293124970298*^9, 
   3.812293131509574*^9}, {3.8122931739781713`*^9, 3.812293176018455*^9}, {
   3.8122934417997026`*^9, 3.812293444682637*^9}, {3.812293859849421*^9, 
   3.812293891379547*^9}, {3.812293992340438*^9, 3.812293995388508*^9}, {
   3.8122941814718513`*^9, 3.8122941948502617`*^9}, {3.8122942599782267`*^9, 
   3.812294262233824*^9}, {3.8122943167737293`*^9, 3.812294319303418*^9}, {
   3.8122943543282957`*^9, 3.812294356788066*^9}, {3.812294415602087*^9, 
   3.812294425141282*^9}, 3.812294527470278*^9, {3.812294625014534*^9, 
   3.812294625213497*^9}, {3.812296785630796*^9, 3.812296787985979*^9}, {
   3.812297230735858*^9, 3.8122972371780767`*^9}, {3.812297402728292*^9, 
   3.812297402935481*^9}, {3.812297441275497*^9, 3.812297442368709*^9}, {
   3.8122974806373787`*^9, 3.812297485995689*^9}, 3.8122975404013023`*^9, {
   3.81229843003544*^9, 3.8122984338421173`*^9}, {3.812298520972622*^9, 
   3.8122985376071033`*^9}, {3.812298683936936*^9, 3.812298685557933*^9}, {
   3.812298740202138*^9, 3.8122987442131853`*^9}, {3.812298911069233*^9, 
   3.8122989142460423`*^9}, {3.812299010737602*^9, 3.812299013615438*^9}, {
   3.812299157210593*^9, 3.8122991618219337`*^9}, {3.812299242672051*^9, 
   3.8122992429362307`*^9}, 3.8123005640417147`*^9, {3.8123006046411543`*^9, 
   3.812300607562223*^9}, {3.8123006592682*^9, 3.812300660403879*^9}, {
   3.812300767761991*^9, 3.812300771277781*^9}, {3.812300842874658*^9, 
   3.8123008643412237`*^9}, {3.8123010097921658`*^9, 3.812301020157228*^9}, {
   3.812301909806978*^9, 3.812301912540319*^9}, {3.81230246407298*^9, 
   3.812302466399953*^9}, {3.812302726754211*^9, 3.812302727673211*^9}, {
   3.812302821888323*^9, 3.81230286025776*^9}, 3.8123028911384583`*^9, 
   3.812303188247471*^9, {3.8123034941636553`*^9, 3.812303519169252*^9}, {
   3.812303590456893*^9, 3.812303590599066*^9}, {3.812303826442457*^9, 
   3.812303826559651*^9}, 3.812303944622198*^9, {3.812369145174067*^9, 
   3.812369148293477*^9}, {3.812370342342957*^9, 3.812370348222904*^9}, 
   3.812371881288307*^9, {3.812372611879656*^9, 3.812372612208728*^9}, 
   3.812384494233974*^9, {3.812384842069067*^9, 3.8123848422772017`*^9}, {
   3.812795081235359*^9, 3.812795086392118*^9}, {3.812795301804785*^9, 
   3.8127953071042967`*^9}, {3.8127953479462748`*^9, 3.8127953520440683`*^9}, 
   3.812795436585795*^9, 3.812795797107657*^9, 3.812797148013517*^9, {
   3.812797382210747*^9, 3.812797440962048*^9}, {3.8128005489975157`*^9, 
   3.8128005517872667`*^9}, {3.812801021756875*^9, 3.812801027028368*^9}, {
   3.812802958342555*^9, 3.812802960888218*^9}, {3.812805893983086*^9, 
   3.81280590944748*^9}, {3.812806144508811*^9, 3.812806145146657*^9}, 
   3.812806358617276*^9, {3.812807004412549*^9, 3.81280700450077*^9}, {
   3.812807568494753*^9, 3.8128075869683247`*^9}, 3.81280788982948*^9, 
   3.812807982786234*^9, 3.812808448445763*^9, 3.815392456574894*^9, {
   3.8153924910986223`*^9, 3.8153924932919817`*^9}, 3.8154091939671297`*^9, {
   3.815420455657671*^9, 3.815420461818263*^9}, {3.815420739440537*^9, 
   3.815420749473454*^9}, {3.81548152558057*^9, 3.8154815353474483`*^9}, 
   3.8154818671483927`*^9, 3.815482043076226*^9, {3.815482255801271*^9, 
   3.81548226099504*^9}, {3.815482583310355*^9, 3.8154826035509367`*^9}, 
   3.815482684835052*^9, {3.8154830986245327`*^9, 3.81548310579438*^9}, 
   3.815483272864222*^9, {3.815486661091872*^9, 3.8154866638112288`*^9}, {
   3.8159139555267*^9, 3.8159139569204063`*^9}, 3.8159149723318863`*^9, {
   3.815915041089925*^9, 3.815915062540037*^9}, 3.815915380995001*^9, 
   3.815916383845079*^9, {3.815916641301528*^9, 3.815916649413835*^9}, 
   3.815917224064823*^9, {3.815918203085294*^9, 3.815918206072544*^9}, {
   3.81591829975996*^9, 3.8159183150776854`*^9}, {3.8159184301675177`*^9, 
   3.81591843058575*^9}, {3.815918584151145*^9, 3.8159186093304768`*^9}, {
   3.815918954847748*^9, 3.8159189645412397`*^9}, 3.815919113657742*^9, 
   3.815919233705534*^9, 3.8159194095440397`*^9, {3.815919788284932*^9, 
   3.815919815751526*^9}, {3.815919948081991*^9, 3.815919950871983*^9}, {
   3.815920006604652*^9, 3.815920007698666*^9}, {3.815920568339011*^9, 
   3.815920589907031*^9}, {3.815920640279356*^9, 3.8159207195615892`*^9}, {
   3.815920761910174*^9, 3.815920773971862*^9}, {3.815920869314396*^9, 
   3.815920885229498*^9}, {3.815930018553606*^9, 3.815930030370185*^9}, {
   3.8159300993183804`*^9, 3.815930104854281*^9}, {3.815930280848421*^9, 
   3.815930281411166*^9}, 3.8159307952277603`*^9, {3.815930894575426*^9, 
   3.815930926817258*^9}, {3.815931035038281*^9, 3.815931044687581*^9}, {
   3.8159313471231833`*^9, 3.815931347503419*^9}, 3.8159326163837757`*^9, 
   3.815936848444516*^9, 3.8159368833165607`*^9, {3.815937798741325*^9, 
   3.815937803842284*^9}, {3.8159996734540243`*^9, 3.8159996767795763`*^9}, {
   3.816002086906713*^9, 3.816002102557796*^9}, {3.816016755903861*^9, 
   3.816016774490835*^9}, {3.816020002681027*^9, 3.8160200155130577`*^9}, {
   3.8160218476429863`*^9, 3.8160218694894114`*^9}, {3.8163616603472977`*^9, 
   3.816361665536281*^9}, {3.8163617099193974`*^9, 3.816361735667714*^9}, 
   3.8163619198615*^9, {3.816362189468569*^9, 3.816362189621826*^9}, 
   3.816362321737443*^9, {3.816426044168912*^9, 3.816426044896268*^9}, {
   3.816426292718939*^9, 3.8164262930653963`*^9}, 3.816426732321142*^9, {
   3.816427381657016*^9, 3.816427397510449*^9}, {3.816427680221168*^9, 
   3.816427680813863*^9}, {3.8164282197522078`*^9, 3.816428223304237*^9}, {
   3.816428545504732*^9, 3.816428548001968*^9}, {3.816430179671356*^9, 
   3.816430187845997*^9}, 3.816453450333843*^9, 3.816453643376693*^9, 
   3.816528956566112*^9, {3.816529430989718*^9, 3.816529451756939*^9}, 
   3.816530888840198*^9, 3.816532631884363*^9, 3.816532910867793*^9, {
   3.819469768126692*^9, 3.819469768392527*^9}, {3.819471427368273*^9, 
   3.8194714277764482`*^9}, {3.8195397551113462`*^9, 3.819539755207293*^9}, 
   3.819732347489119*^9, 3.819732472573779*^9, {3.819732509755477*^9, 
   3.819732510657901*^9}, 3.8197326514678392`*^9, {3.819733489755109*^9, 
   3.8197334899032583`*^9}, {3.819733753721737*^9, 3.8197337538688602`*^9}, {
   3.819973728536215*^9, 3.819973750862651*^9}, 3.8199741939789667`*^9, 
   3.8199839917428217`*^9, {3.8199841522920103`*^9, 3.819984152409403*^9}, 
   3.819984325901393*^9, {3.819985316457141*^9, 3.81998531699223*^9}, {
   3.819986365898157*^9, 3.819986366053727*^9}, {3.820066251934805*^9, 
   3.820066286175562*^9}, {3.820074549448802*^9, 3.820074551712153*^9}, 
   3.8200745995815783`*^9, {3.8200750984704847`*^9, 3.8200751002196407`*^9}, 
   3.820075368114395*^9, 3.8200760629103727`*^9, 3.8200853626833887`*^9, 
   3.820085422630908*^9, {3.8200854581242332`*^9, 3.8200854583887787`*^9}, {
   3.820146074239078*^9, 3.820146074337578*^9}, {3.820146290485989*^9, 
   3.820146310921031*^9}, 3.8201464619265127`*^9, {3.82024751836342*^9, 
   3.820247545839881*^9}, {3.8202482745550222`*^9, 3.820248274913644*^9}, {
   3.820677800071128*^9, 3.8206778305654593`*^9}, 3.8206796433676567`*^9, 
   3.820684433922215*^9, {3.8206854995695667`*^9, 3.820685499643573*^9}, {
   3.820761139348852*^9, 3.820761139412613*^9}, {3.82137115283561*^9, 
   3.821371153169524*^9}, 3.82137215989401*^9, {3.821372208844553*^9, 
   3.821372211136488*^9}, {3.821372440580955*^9, 3.821372442082673*^9}, {
   3.8213726073436832`*^9, 3.821372612101767*^9}, {3.821372644026196*^9, 
   3.8213726546857862`*^9}, 3.8213727452764673`*^9, 3.821372816933597*^9, {
   3.821377424029314*^9, 3.8213774252807713`*^9}, {3.821377508962756*^9, 
   3.821377510839323*^9}, {3.821377644273079*^9, 3.821377670184609*^9}, {
   3.8213778053627453`*^9, 3.8213778322697363`*^9}, 3.8213779415368853`*^9, {
   3.8213779754501762`*^9, 3.82137797707434*^9}, {3.8213780900463448`*^9, 
   3.821378090219864*^9}, {3.821378130245943*^9, 3.821378134664302*^9}, {
   3.821378195057282*^9, 3.8213781951589937`*^9}, {3.821379029640356*^9, 
   3.821379041234646*^9}, {3.821379213741037*^9, 3.82137921381059*^9}, {
   3.821379268293709*^9, 3.8213792822376823`*^9}, {3.821383603372635*^9, 
   3.8213836034958773`*^9}, 3.821529676764312*^9, {3.8219647332976217`*^9, 
   3.82196477821877*^9}, {3.8220540927677803`*^9, 3.8220540929477777`*^9}, 
   3.822059062776175*^9, {3.8231867218009977`*^9, 3.823186746701519*^9}, 
   3.823186900972728*^9, 3.823186985900272*^9, 3.8231872684630527`*^9, 
   3.823258828213273*^9, {3.823276751222258*^9, 3.823276751878454*^9}, {
   3.823277248269758*^9, 3.8232772502235403`*^9}, {3.823277301608987*^9, 
   3.82327732372266*^9}, {3.8232773768488493`*^9, 3.823277385161632*^9}, {
   3.823354329853963*^9, 3.823354374633051*^9}, {3.8233550672152653`*^9, 
   3.82335510483569*^9}, {3.823355846025666*^9, 3.823355850400877*^9}, {
   3.823356375650487*^9, 3.82335638718099*^9}, 3.823356638611661*^9, {
   3.823358759979453*^9, 3.823358829038639*^9}, {3.823360495787045*^9, 
   3.8233606155880938`*^9}, 3.823360709185259*^9, {3.823360782068413*^9, 
   3.823360828074048*^9}, 3.823360862774787*^9, {3.8233612456969233`*^9, 
   3.8233612785627623`*^9}, {3.823361338042308*^9, 3.8233614014767847`*^9}, {
   3.823361819034419*^9, 3.8233618583386602`*^9}, {3.823362352144032*^9, 
   3.823362357554614*^9}, {3.823603336887515*^9, 3.8236033555068197`*^9}, {
   3.823604333338599*^9, 3.823604337121241*^9}, {3.823604701358395*^9, 
   3.8236047167944813`*^9}, {3.8236061896258087`*^9, 3.823606195963368*^9}, {
   3.823623453703115*^9, 3.8236234598786716`*^9}, {3.823624100539509*^9, 
   3.8236241030694036`*^9}, 3.823687963639204*^9, {3.823690138435788*^9, 
   3.8236902046651917`*^9}, {3.82369040312543*^9, 3.82369041339793*^9}, {
   3.823690458075992*^9, 3.82369049436409*^9}, 3.823690563294881*^9, {
   3.823690637516633*^9, 3.8236906499605103`*^9}, {3.823693810324979*^9, 
   3.8236938257007113`*^9}, {3.823694186027019*^9, 3.823694188000073*^9}, {
   3.82369492344376*^9, 3.823694962858471*^9}, 3.823698542738264*^9, {
   3.823701259313792*^9, 3.8237012823288603`*^9}, {3.8237132954891*^9, 
   3.823713298141306*^9}, 3.823771801735714*^9, {3.823774556281911*^9, 
   3.823774579833008*^9}, {3.823952427717947*^9, 3.823952428935265*^9}, {
   3.8239686334819813`*^9, 3.823968637478758*^9}, 3.823973993111155*^9, {
   3.823974052379888*^9, 3.823974056905164*^9}, {3.82397450486392*^9, 
   3.8239745055059557`*^9}, 3.823975827152975*^9, 3.8241414266896353`*^9, {
   3.82437945545656*^9, 3.824379460402397*^9}, {3.824382739750244*^9, 
   3.8243827528636627`*^9}, 3.824410437296386*^9, {3.8244106372051888`*^9, 
   3.824410637511156*^9}, 3.824410710032381*^9, 3.824411228990996*^9, {
   3.8244120207630577`*^9, 3.8244120208595457`*^9}, {3.824412242525154*^9, 
   3.824412243922002*^9}, 3.8244131483226852`*^9, {3.824413714508953*^9, 
   3.824413743114452*^9}, {3.824414105345402*^9, 3.824414131395782*^9}, 
   3.8244612479124517`*^9, {3.824468749222046*^9, 3.82446874943324*^9}, {
   3.824469071604707*^9, 3.8244690717245617`*^9}, {3.824469318281825*^9, 
   3.824469318642276*^9}, {3.824471026764824*^9, 3.82447103034974*^9}, 
   3.8244769680875*^9, 3.8244804096464252`*^9, {3.8244814964120073`*^9, 
   3.824481496562376*^9}, {3.824482169296081*^9, 3.824482169422476*^9}, {
   3.8244833223144903`*^9, 3.824483322419058*^9}, {3.824484288383286*^9, 
   3.824484288426372*^9}, {3.824484959879208*^9, 3.824484960037682*^9}, 
   3.824485799017062*^9, {3.824491712874806*^9, 3.82449172130261*^9}, {
   3.824491755639037*^9, 3.824491758953329*^9}, {3.8244919774923697`*^9, 
   3.824491978651677*^9}, {3.824492086034543*^9, 3.8244920968926687`*^9}, {
   3.824492480633847*^9, 3.8244924911383247`*^9}, {3.82449260822738*^9, 
   3.824492614245009*^9}, {3.8244930134148197`*^9, 3.8244930154494333`*^9}, {
   3.824493397517308*^9, 3.824493400331118*^9}, 3.824493536577374*^9, {
   3.824493571493371*^9, 3.824493589311504*^9}, {3.824493629915061*^9, 
   3.824493633585231*^9}, 3.824493697695731*^9, {3.824493744671885*^9, 
   3.824493768692247*^9}, 3.824493819105916*^9, {3.82449390608992*^9, 
   3.824493916437793*^9}, 3.824493963513588*^9, 3.824494024476259*^9, 
   3.824494093610952*^9, {3.824494167886512*^9, 3.824494169475438*^9}, {
   3.824494248737742*^9, 3.824494259671406*^9}, {3.8244943498896427`*^9, 
   3.824494368208419*^9}, {3.824494451038209*^9, 3.824494464193882*^9}, 
   3.824494571682438*^9, {3.824494633085661*^9, 3.8244946434411592`*^9}, {
   3.8244947089862633`*^9, 3.824494710109528*^9}, {3.824494838064609*^9, 
   3.8244948441623793`*^9}, 3.824494899517166*^9, {3.824494942376474*^9, 
   3.824494967400099*^9}, 3.824495336195929*^9, {3.82449538416643*^9, 
   3.824495391778504*^9}, {3.824495485962654*^9, 3.824495486123534*^9}, 
   3.824496946764797*^9, 3.824497147041007*^9, 3.824498670139642*^9, {
   3.824499554970436*^9, 3.824499555125655*^9}, {3.8245008899777737`*^9, 
   3.824500907407921*^9}, 3.8245009721617813`*^9, {3.824501028593796*^9, 
   3.8245010384600267`*^9}, {3.824501397182929*^9, 3.8245013990754843`*^9}, 
   3.824501472054173*^9, 3.824502314631413*^9, {3.824502547756926*^9, 
   3.8245025481770267`*^9}, {3.824502654600952*^9, 3.8245026642703047`*^9}, {
   3.8245027038038797`*^9, 3.824502704137587*^9}, 3.82450273723881*^9, {
   3.8245033133834877`*^9, 3.824503318344039*^9}, {3.8245042451583147`*^9, 
   3.824504252210175*^9}, {3.82454576558545*^9, 3.8245457673866673`*^9}, {
   3.824545847422228*^9, 3.824545870640326*^9}, {3.8245464363513403`*^9, 
   3.824546449058463*^9}, 3.8245465218414593`*^9, {3.824549811953105*^9, 
   3.824549821934454*^9}, {3.824554475371049*^9, 3.8245544861120462`*^9}, 
   3.824554720899143*^9, {3.824555032528363*^9, 3.8245550383537292`*^9}, {
   3.824555798381572*^9, 3.824555816983818*^9}, {3.8245560706075077`*^9, 
   3.824556078281468*^9}, 3.824558601993348*^9, 3.82456034035841*^9, {
   3.8245687882784357`*^9, 3.824568789462473*^9}, {3.824568823504283*^9, 
   3.824568832453084*^9}, 3.824569055012978*^9, {3.8245692045752897`*^9, 
   3.824569204990238*^9}, {3.824570037456352*^9, 3.8245700403411713`*^9}, 
   3.824570491975258*^9, 3.82457340064336*^9, {3.824576041462823*^9, 
   3.8245760414988127`*^9}, {3.824577712495678*^9, 3.824577723480227*^9}, {
   3.824578342643298*^9, 3.8245783448748693`*^9}, {3.824579240866201*^9, 
   3.82457924404547*^9}, {3.8245797070453672`*^9, 3.824579707207906*^9}, 
   3.824579785278674*^9, 3.824581852931054*^9, 3.824582293024435*^9, {
   3.824585253539732*^9, 3.824585277832926*^9}, {3.824588480019827*^9, 
   3.824588480037505*^9}, {3.824594074581046*^9, 3.824594161539977*^9}, 
   3.824601844011273*^9, 3.8246511022486563`*^9, {3.824652240962541*^9, 
   3.8246522423486233`*^9}, 3.824656140520975*^9, 3.82465629569659*^9, {
   3.8246574793187943`*^9, 3.824657480083178*^9}, 3.824658352124757*^9, {
   3.824674736855955*^9, 3.824674737105611*^9}, {3.824674942633939*^9, 
   3.824674946285067*^9}, 3.824675407614192*^9, {3.824675722041827*^9, 
   3.824675722164247*^9}, {3.8246758595024767`*^9, 3.82467585959861*^9}, {
   3.824676023944257*^9, 3.8246760305146646`*^9}, {3.8246761199662952`*^9, 
   3.8246761200541773`*^9}, {3.82467792839406*^9, 3.824677928509223*^9}, {
   3.824677996975586*^9, 3.824677997073854*^9}, 3.82468273307833*^9, 
   3.824689538610014*^9, 3.824689621153789*^9, {3.824689725170753*^9, 
   3.824689725265126*^9}, {3.824719738878327*^9, 3.824719739082161*^9}, {
   3.824720415237578*^9, 3.824720415370283*^9}, {3.82472047587001*^9, 
   3.824720475962554*^9}, {3.82472209174585*^9, 3.824722092555276*^9}, {
   3.824846984935656*^9, 3.824846988008669*^9}, {3.829989514742341*^9, 
   3.829989602037312*^9}, 3.829989655798883*^9, {3.829989880716971*^9, 
   3.829989912460012*^9}, {3.830511435622458*^9, 3.830511446859633*^9}, 
   3.830511496759448*^9, {3.830514691728743*^9, 3.830514692214171*^9}, {
   3.8305254813218613`*^9, 3.83052548134723*^9}, {3.8305371218954067`*^9, 
   3.830537126759416*^9}, {3.830611589326541*^9, 3.8306115894371777`*^9}, 
   3.830616594177703*^9, {3.8306170798734417`*^9, 3.830617080022849*^9}, {
   3.831031097528778*^9, 3.831031097546574*^9}, {3.831035643256023*^9, 
   3.831035643372965*^9}, {3.831036222157131*^9, 3.831036222317141*^9}, {
   3.831203221033771*^9, 3.831203221117064*^9}, {3.831476778419798*^9, 
   3.8314767785441303`*^9}, {3.831477015672556*^9, 3.8314770158556557`*^9}, 
   3.831486658447269*^9, {3.831544056489176*^9, 3.83154413658794*^9}, {
   3.831544599900083*^9, 3.83154468161555*^9}, {3.831548920748048*^9, 
   3.8315489458955383`*^9}, {3.831553516871561*^9, 3.831553529130679*^9}, 
   3.831573399506818*^9, 3.8315735584235573`*^9, 3.8315755661067963`*^9, 
   3.8316325217849417`*^9, 3.831633842935753*^9, {3.831647630350892*^9, 
   3.831647635514162*^9}, 3.831653324726994*^9, 3.8317170830317717`*^9, {
   3.8317183741894627`*^9, 3.831718393256557*^9}, 3.83174089517389*^9, {
   3.831740964587123*^9, 3.8317409791590977`*^9}, {3.831741075273628*^9, 
   3.831741076006957*^9}, 3.831742650355434*^9, {3.8317530613161907`*^9, 
   3.8317530698014717`*^9}, {3.83180315367906*^9, 3.8318031645040617`*^9}, {
   3.831808008107655*^9, 3.83180801329858*^9}, {3.831808334861651*^9, 
   3.8318083349965067`*^9}, 3.831808466750003*^9, 3.8318085281197433`*^9, {
   3.83181949147539*^9, 3.831819498531075*^9}, {3.8318277996031103`*^9, 
   3.8318278065353823`*^9}, 3.8320705206555233`*^9, 3.832070803004136*^9, {
   3.8322415756194344`*^9, 3.832241584028809*^9}, {3.832257402359761*^9, 
   3.8322574025671663`*^9}, 3.832258770055026*^9, {3.832260820094532*^9, 
   3.8322608250997057`*^9}, 3.83241838916847*^9, 3.8326849628407383`*^9, 
   3.832685459921321*^9, {3.8326857345663433`*^9, 3.832685735133979*^9}, 
   3.832693828731742*^9, {3.8326982988300533`*^9, 3.8326982989760227`*^9}, {
   3.832757692030427*^9, 3.8327576935318527`*^9}, 3.832758487325899*^9, {
   3.832758522611813*^9, 3.832758522757524*^9}, 3.832759903125404*^9, 
   3.832771761854797*^9, 3.832772092312181*^9, 3.832772378871694*^9, 
   3.8327777721299334`*^9, {3.832778255116062*^9, 3.83277825519536*^9}, 
   3.8327786087437077`*^9, {3.832782177853518*^9, 3.832782183394588*^9}, {
   3.832847775396257*^9, 3.832847779696179*^9}, {3.8328621967317743`*^9, 
   3.8328622000722723`*^9}, {3.8328638174477158`*^9, 3.832863817567882*^9}, {
   3.832867375595811*^9, 3.8328673841460533`*^9}, 3.832941338809259*^9, {
   3.8329459277243223`*^9, 3.832945930607555*^9}, {3.8329463695397167`*^9, 
   3.832946369653263*^9}, {3.832948192190167*^9, 3.8329481925418587`*^9}, {
   3.833293493616825*^9, 3.833293494777278*^9}, {3.833383110923499*^9, 
   3.833383115198398*^9}, {3.833383241423523*^9, 3.833383241521731*^9}, {
   3.833466334050963*^9, 3.8334663343377953`*^9}, 3.833466435874208*^9, {
   3.83459398735355*^9, 3.8345939876539392`*^9}, {3.834594184089438*^9, 
   3.834594187210463*^9}, {3.8345948106412897`*^9, 3.834594823251266*^9}, 
   3.834596447974815*^9, 3.834655746933361*^9, 3.8346572644287853`*^9, {
   3.8347428950473137`*^9, 3.834742904732718*^9}, 3.834743186730094*^9, {
   3.834751187708606*^9, 3.8347511959038153`*^9}, {3.834757030334469*^9, 
   3.834757030811183*^9}, {3.834763148343298*^9, 3.834763148664187*^9}, {
   3.834766072634737*^9, 3.834766072984228*^9}, 3.834766238874166*^9, {
   3.834827633670229*^9, 3.834827633759055*^9}, 3.8348299177042627`*^9, 
   3.834830258998584*^9, {3.834831426450355*^9, 3.834831426756007*^9}, 
   3.834832584831909*^9, {3.834832631975512*^9, 3.834832639735272*^9}, {
   3.834833061993587*^9, 3.834833079479603*^9}, 3.834833745270382*^9, {
   3.834833842628992*^9, 3.8348338429009247`*^9}, {3.8348344139582157`*^9, 
   3.834834414147791*^9}, 3.834834529284032*^9, {3.8348357860657597`*^9, 
   3.8348357877192698`*^9}, {3.834835880103257*^9, 3.834835880434967*^9}, {
   3.834836662637192*^9, 3.834836662929764*^9}, 3.834841381848423*^9, 
   3.834842046548567*^9, 3.834842961463656*^9, 3.834850075221129*^9, 
   3.834850364692037*^9, 3.834850461031384*^9, {3.835092175421053*^9, 
   3.83509218194565*^9}, {3.835092328099895*^9, 3.8350923310084867`*^9}, 
   3.835092706819311*^9, 3.835102266505163*^9, 3.8351038868303137`*^9, 
   3.835108364156933*^9, 3.835109580777031*^9, {3.835112258570853*^9, 
   3.835112258705514*^9}, {3.835173483449799*^9, 3.8351735117482433`*^9}, {
   3.835176216520455*^9, 3.835176253916696*^9}, {3.835177054432707*^9, 
   3.835177067186037*^9}, {3.8351771007968273`*^9, 3.83517710482305*^9}, {
   3.835177159410508*^9, 3.835177200576289*^9}, {3.8351772310191507`*^9, 
   3.8351772705377493`*^9}, {3.83517834205418*^9, 3.835178347141088*^9}, {
   3.835178672135365*^9, 3.835178678117738*^9}, {3.83517915086117*^9, 
   3.835179154147079*^9}, 3.835179525346792*^9, {3.8351802759779873`*^9, 
   3.835180289941236*^9}, {3.835180498897543*^9, 3.835180504203664*^9}, {
   3.835183018823934*^9, 3.8351830219316473`*^9}, {3.835183597851571*^9, 
   3.835183617144773*^9}, {3.835183655857258*^9, 3.835183687056574*^9}, {
   3.835190391192082*^9, 3.835190400234989*^9}, {3.8351905837746162`*^9, 
   3.835190587045301*^9}, {3.83519064362633*^9, 3.8351906511441917`*^9}, {
   3.83519186009225*^9, 3.835191869926903*^9}, {3.835191917899403*^9, 
   3.83519195426164*^9}, {3.8351922962058687`*^9, 3.835192305683522*^9}, {
   3.835192619837935*^9, 3.835192633864287*^9}, {3.835193841240609*^9, 
   3.8351938890020742`*^9}, 3.835194444602276*^9, {3.83519448162547*^9, 
   3.835194538835277*^9}, {3.835194907201537*^9, 3.835194916678535*^9}, {
   3.835194947434949*^9, 3.8351949905566683`*^9}, {3.8351955693291397`*^9, 
   3.8351955917207613`*^9}, {3.835196291656901*^9, 3.835196309269205*^9}, {
   3.835196616581573*^9, 3.8351966277784367`*^9}, {3.83519692409805*^9, 
   3.8351969242456293`*^9}, {3.835197301387293*^9, 3.835197331978176*^9}, {
   3.8351974330644217`*^9, 3.835197455358531*^9}, {3.8351980064986134`*^9, 
   3.8351980093630533`*^9}, {3.835198540360824*^9, 3.8351985674301577`*^9}, {
   3.835199980671433*^9, 3.835199997392323*^9}, {3.835262653606791*^9, 
   3.835262659369582*^9}, {3.8352641687219563`*^9, 3.835264182288313*^9}, {
   3.835265007621646*^9, 3.835265132978218*^9}, {3.83526750968114*^9, 
   3.8352675263953543`*^9}, {3.835271134430439*^9, 3.835271146591187*^9}, {
   3.83527130610849*^9, 3.835271311219296*^9}, {3.8352742557555447`*^9, 
   3.835274275833157*^9}, 3.835274945567725*^9, {3.835275277576985*^9, 
   3.835275282738942*^9}, {3.835275894244038*^9, 3.835275939446355*^9}, {
   3.835277330881167*^9, 3.8352773529746933`*^9}, {3.835283561746182*^9, 
   3.835283604033843*^9}, {3.835283637618505*^9, 3.835283684536867*^9}, {
   3.8352837568884163`*^9, 3.835283758394034*^9}, {3.835286066992778*^9, 
   3.835286121980225*^9}, {3.8352861521159563`*^9, 3.8352861740771103`*^9}, {
   3.835286929010169*^9, 3.835286949591872*^9}, {3.835346665145402*^9, 
   3.835346708448056*^9}, {3.835346748575014*^9, 3.835346751318446*^9}, {
   3.835348911533306*^9, 3.835348912124097*^9}, {3.8353499436118383`*^9, 
   3.835349943766489*^9}, 3.835351095623351*^9, 3.835351553646503*^9, {
   3.83535224593209*^9, 3.835352258572028*^9}, {3.835352898069886*^9, 
   3.835352898319632*^9}, {3.835353409021864*^9, 3.835353412004641*^9}, {
   3.8353541756512814`*^9, 3.835354178343213*^9}, {3.835354412700335*^9, 
   3.835354412950841*^9}, {3.835354931938403*^9, 3.8353549343379583`*^9}, {
   3.835355161350313*^9, 3.835355167350568*^9}, {3.8353558221950293`*^9, 
   3.835355824250682*^9}, {3.835360617316148*^9, 3.8353606259054737`*^9}, 
   3.835360673007964*^9, {3.835364774664802*^9, 3.835364776340891*^9}, {
   3.8353688435005817`*^9, 3.835368870273938*^9}, 3.8353689722912083`*^9, {
   3.835369578201137*^9, 3.835369582833392*^9}, {3.83536963212061*^9, 
   3.835369633568508*^9}, {3.835371380549184*^9, 3.8353713994237347`*^9}, {
   3.835371884758871*^9, 3.835371945507621*^9}, {3.835371982429647*^9, 
   3.8353720053134327`*^9}, {3.8353729727011023`*^9, 3.835372979807404*^9}, {
   3.835373028339613*^9, 3.8353730376604233`*^9}, {3.8353734882641706`*^9, 
   3.835373503501165*^9}, {3.835373751119479*^9, 3.83537375255504*^9}, {
   3.8353748752585487`*^9, 3.8353748986556387`*^9}, {3.83543112747535*^9, 
   3.835431133284197*^9}, 3.835431780158753*^9, {3.835434725362328*^9, 
   3.835434730509069*^9}, 3.835435581031542*^9, {3.835436075556943*^9, 
   3.835436088857777*^9}, {3.835449989881668*^9, 3.835449997240096*^9}, {
   3.835450047437291*^9, 3.835450150465197*^9}, {3.835450184519182*^9, 
   3.835450211022769*^9}, {3.835450241129047*^9, 3.8354502501391153`*^9}, {
   3.835450449733766*^9, 3.835450482384078*^9}, {3.83545053204344*^9, 
   3.835450532732201*^9}, 3.835450566369425*^9, {3.835450607308566*^9, 
   3.835450612043315*^9}, {3.8354506708582478`*^9, 3.8354506723840857`*^9}, {
   3.835450746151566*^9, 3.8354507661763077`*^9}, {3.8354508356997128`*^9, 
   3.835450836709855*^9}, {3.835452653002746*^9, 3.8354527282415743`*^9}, {
   3.835455036538165*^9, 3.835455040704797*^9}, {3.8354577006925583`*^9, 
   3.8354577028434896`*^9}, 3.835461486316723*^9, {3.835466907853498*^9, 
   3.8354669154835997`*^9}, {3.835467685744318*^9, 3.835467686168734*^9}, {
   3.835468880099365*^9, 3.835468885705039*^9}, {3.835469821946382*^9, 
   3.835469824622767*^9}, {3.835472690329018*^9, 3.835472691972723*^9}, {
   3.8354732847283792`*^9, 3.835473287388708*^9}, {3.835519280721225*^9, 
   3.835519283818404*^9}, 3.835521766234023*^9, 3.835521948917666*^9, {
   3.835523291398349*^9, 3.8355233186131077`*^9}, 3.8355359645462427`*^9, {
   3.83553711333989*^9, 3.835537114966844*^9}, {3.835539674320301*^9, 
   3.835539678283692*^9}, {3.8355415291356497`*^9, 3.8355415324263687`*^9}, {
   3.835546362952829*^9, 3.835546367829172*^9}, 3.835546673058127*^9, {
   3.835546833175252*^9, 3.835546840542079*^9}, {3.835546955684126*^9, 
   3.8355469615753813`*^9}, {3.8355472090657053`*^9, 3.835547211679345*^9}, {
   3.835547386125451*^9, 3.835547388157769*^9}, {3.835547626539917*^9, 
   3.835547628945211*^9}, {3.835547984096633*^9, 3.835547989772773*^9}, 
   3.835548426857147*^9, {3.835548499977034*^9, 3.835548514670495*^9}, 
   3.835549605298604*^9, {3.8355497885470448`*^9, 3.835549791683075*^9}, 
   3.835550340418297*^9, 3.8356065638774*^9, {3.835607076940117*^9, 
   3.8356070888782473`*^9}, {3.8356083067952414`*^9, 3.83560831388662*^9}, 
   3.835608960731229*^9, {3.835609165966236*^9, 3.835609185065641*^9}, 
   3.835609587694675*^9, 3.835610386850667*^9, {3.835611258261477*^9, 
   3.835611258653234*^9}, 3.835612084281921*^9, {3.835631032993718*^9, 
   3.835631033476293*^9}, 3.8356316742168207`*^9, {3.835632848002099*^9, 
   3.83563284837582*^9}, {3.8356329590294933`*^9, 3.835632963708612*^9}, {
   3.835633587298517*^9, 3.83563359045725*^9}, {3.835633682759083*^9, 
   3.835633684884879*^9}, {3.8356339098124847`*^9, 3.835633914307781*^9}, {
   3.8356346493227654`*^9, 3.835634652954937*^9}, {3.835634853499305*^9, 
   3.8356348588756533`*^9}, {3.8356352393159437`*^9, 3.835635239741207*^9}, {
   3.835635786069881*^9, 3.835635786073039*^9}, {3.8356358676266413`*^9, 
   3.835635874615375*^9}, {3.8356368728934507`*^9, 3.8356368760176477`*^9}, {
   3.835637301966064*^9, 3.835637304644854*^9}, {3.835637369520919*^9, 
   3.8356373709042253`*^9}, {3.835637915749569*^9, 3.8356379262336073`*^9}, {
   3.8356380051986523`*^9, 3.835638005346799*^9}, {3.835638246143506*^9, 
   3.8356382467267942`*^9}, {3.835638598823629*^9, 3.835638599625251*^9}, {
   3.83563874615102*^9, 3.835638746279097*^9}, 3.835638838643261*^9, 
   3.835639039679661*^9, {3.835640259786871*^9, 3.835640265114506*^9}, {
   3.8356415594544497`*^9, 3.835641566351548*^9}, 3.835641859324967*^9, {
   3.835642344618906*^9, 3.835642346991308*^9}, {3.835642410074106*^9, 
   3.835642410213546*^9}, {3.835643503225967*^9, 3.835643506103808*^9}, {
   3.83564433258225*^9, 3.8356443418775253`*^9}, {3.835645449767379*^9, 
   3.835645454387128*^9}, 3.835645940890593*^9, {3.835647200865821*^9, 
   3.8356472325129547`*^9}, {3.835656395345228*^9, 3.835656395585311*^9}, {
   3.835658828581891*^9, 3.835658828731573*^9}, 3.835687781607276*^9, {
   3.835689309339093*^9, 3.835689309430286*^9}, {3.8356897474863358`*^9, 
   3.835689747647252*^9}, {3.8356901381106167`*^9, 3.835690140850317*^9}, {
   3.8357002722020597`*^9, 3.8357002923498697`*^9}, 3.835708602650674*^9, 
   3.8357117569791803`*^9, {3.835712066430442*^9, 3.835712081564542*^9}, {
   3.835719042647882*^9, 3.835719072096448*^9}, {3.835720657054874*^9, 
   3.835720671166284*^9}, {3.835790333656633*^9, 3.835790337720249*^9}, 
   3.835794047888351*^9, 3.8357995109153*^9, {3.835804592920411*^9, 
   3.83580460131318*^9}, {3.835811405811571*^9, 3.835811409366666*^9}, {
   3.836139551074511*^9, 3.8361396266117687`*^9}, {3.8361400933260107`*^9, 
   3.836140099034227*^9}, {3.836140567088771*^9, 3.836140622028061*^9}, {
   3.836140689910894*^9, 3.836140701283955*^9}, {3.8361424866459913`*^9, 
   3.836142489847726*^9}, {3.836143553958946*^9, 3.836143561141139*^9}, 
   3.8361480221739283`*^9, {3.836150261136323*^9, 3.8361502685676937`*^9}, 
   3.836152530262444*^9, {3.836155684858142*^9, 3.836155690035212*^9}, 
   3.836159593904134*^9, {3.836164581603735*^9, 3.836164587280181*^9}, 
   3.83616931652707*^9, {3.836171930371501*^9, 3.836171930467889*^9}, {
   3.8361792812940407`*^9, 3.836179301388916*^9}, {3.836207766874269*^9, 
   3.836207780686399*^9}, 3.836213120778802*^9, 3.83621950231288*^9, 
   3.836220074288919*^9, 3.836221718670507*^9, {3.836224190539587*^9, 
   3.8362241933496513`*^9}, {3.836224318363078*^9, 3.836224340019734*^9}, {
   3.8362243754856987`*^9, 3.836224375584313*^9}, {3.836227540199216*^9, 
   3.8362275440004997`*^9}, {3.8362300630609627`*^9, 3.836230063816594*^9}, {
   3.836232275208941*^9, 3.8362322784917603`*^9}, 3.83623423086828*^9, 
   3.8362371960657*^9, {3.8362385438609324`*^9, 3.8362385442771997`*^9}, {
   3.836240598201318*^9, 3.83624059901373*^9}, {3.8362419613204317`*^9, 
   3.836241962006974*^9}, {3.83624338389583*^9, 3.836243384793947*^9}, {
   3.836256376651741*^9, 3.836256391781005*^9}, {3.836259012441062*^9, 
   3.8362590168238707`*^9}, 3.836294694579359*^9, 3.8362963086328983`*^9, 
   3.836299776081442*^9, {3.8363023252655478`*^9, 3.836302346654272*^9}, {
   3.8363031624011793`*^9, 3.836303184212966*^9}, {3.836303215468656*^9, 
   3.836303217392302*^9}, 3.836305727883378*^9, 3.836308520510829*^9, {
   3.836315249495007*^9, 3.836315250856617*^9}, 3.8363199647469587`*^9, 
   3.836325363334527*^9, {3.836329104346115*^9, 3.836329105527258*^9}, 
   3.83633309663033*^9, {3.8363430376918373`*^9, 3.836343052316739*^9}, {
   3.8364698341121607`*^9, 3.836469853862442*^9}, {3.836492760426173*^9, 
   3.836492767372239*^9}, {3.8365182432862473`*^9, 3.836518250892527*^9}, {
   3.837074391993764*^9, 3.837074451397306*^9}, {3.837074829632812*^9, 
   3.837074850303533*^9}, {3.841481488241457*^9, 3.841481500423806*^9}, {
   3.841481914425673*^9, 3.8414819166717167`*^9}, 3.8419983944730663`*^9, 
   3.8420010769030933`*^9, {3.842002054336804*^9, 3.8420020722470903`*^9}, {
   3.8420023093998613`*^9, 3.842002317518053*^9}, 3.8420052874649277`*^9, 
   3.842005721173195*^9, {3.8426895741405697`*^9, 3.842689589532139*^9}, {
   3.84322697302175*^9, 3.843226973332077*^9}, {3.843227062327504*^9, 
   3.843227071861596*^9}, {3.843239909135166*^9, 3.8432399219784307`*^9}, {
   3.843739778925325*^9, 3.843739779062771*^9}, 3.843740527267536*^9, {
   3.843740708989615*^9, 3.843740709077368*^9}, {3.8437408915470047`*^9, 
   3.843740897230722*^9}, {3.843742533643969*^9, 3.843742533814537*^9}, {
   3.843748428243691*^9, 3.843748432344982*^9}, 3.843748654350521*^9, {
   3.8437488637223663`*^9, 3.843748875313971*^9}, 3.8437518895708857`*^9, 
   3.84391459188412*^9, {3.84391519039119*^9, 3.8439151920700703`*^9}, 
   3.843915300920294*^9, {3.843915463046009*^9, 3.843915477643146*^9}, {
   3.84391574428614*^9, 3.8439157468111973`*^9}, 3.84391699649901*^9, 
   3.8439178882601337`*^9, 3.843922788105219*^9, 3.844166209124114*^9, 
   3.8442538518093643`*^9, 3.844260135659666*^9, {3.844845788879637*^9, 
   3.8448457937229137`*^9}, {3.844846166863648*^9, 3.844846167199209*^9}, {
   3.8448462901885366`*^9, 3.8448463242268333`*^9}, 3.8448480363554783`*^9, 
   3.844855844867051*^9, {3.844856065873721*^9, 3.844856069574379*^9}, {
   3.844856199674197*^9, 3.844856201403325*^9}, {3.844863113254751*^9, 
   3.844863115275509*^9}, {3.844864888725334*^9, 3.8448648900974607`*^9}, 
   3.8448700641497107`*^9, 3.844872783899458*^9, 3.8448747701052027`*^9, 
   3.8448752190916*^9, {3.844877282835391*^9, 3.8448773101011877`*^9}, {
   3.8448783221815*^9, 3.8448783254313793`*^9}, 3.844879614347968*^9, 
   3.844882007921904*^9, 3.8448823232380543`*^9, {3.844941950726104*^9, 
   3.844941975824149*^9}, {3.844942108145712*^9, 3.844942114142436*^9}, {
   3.8449455810649347`*^9, 3.844945584216565*^9}, {3.844945754223756*^9, 
   3.844945769120434*^9}, 3.844947593750298*^9, {3.844947966681582*^9, 
   3.8449480102506227`*^9}, 3.844948244106728*^9, 3.8449489530189667`*^9, {
   3.844950044011249*^9, 3.844950044277495*^9}, 3.844957071543461*^9, {
   3.844961001362109*^9, 3.844961025831657*^9}, {3.8449612377671432`*^9, 
   3.844961238206471*^9}, 3.8449614029897547`*^9, {3.8449614775793047`*^9, 
   3.844961489501568*^9}, {3.84496345597742*^9, 3.8449634595041847`*^9}, 
   3.844963568427742*^9, {3.8449637079596157`*^9, 3.844963721997798*^9}, 
   3.844965691083585*^9, 3.844966417979518*^9, {3.844966711895177*^9, 
   3.844966714710401*^9}, {3.845031107294063*^9, 3.845031146331912*^9}, 
   3.845109906477491*^9, 3.845110620083844*^9, {3.845112470725471*^9, 
   3.845112472880999*^9}, {3.845121835780406*^9, 3.845121839078734*^9}, {
   3.845121879243977*^9, 3.845121907778674*^9}, {3.8451219582394333`*^9, 
   3.845121958434967*^9}, {3.845122654842204*^9, 3.845122656282112*^9}, 
   3.8451238952597313`*^9, {3.845125527907577*^9, 3.8451255295032463`*^9}, 
   3.845126555029566*^9, 3.845128339891942*^9, {3.845129406977528*^9, 
   3.845129414235044*^9}, {3.8451300202456408`*^9, 3.845130023680265*^9}, {
   3.84513031488309*^9, 3.845130315194708*^9}, {3.8451305464527607`*^9, 
   3.845130551832087*^9}, 3.845131523591223*^9, {3.8451322107048273`*^9, 
   3.8451322113338537`*^9}, 3.845133037532124*^9, {3.845133261341919*^9, 
   3.845133265152855*^9}, {3.845133883852376*^9, 3.8451338847530527`*^9}, {
   3.845135210086274*^9, 3.84513521227221*^9}, {3.845136814732891*^9, 
   3.8451368280821743`*^9}, 3.8451374768089323`*^9, {3.845137998774135*^9, 
   3.845138000670699*^9}, {3.8453716230677347`*^9, 3.8453716325363092`*^9}, {
   3.845373165097043*^9, 3.8453731699543447`*^9}, {3.845374544619669*^9, 
   3.845374551899081*^9}, {3.8453754240594187`*^9, 3.8453754286031113`*^9}, 
   3.845375542464628*^9, {3.845376104135931*^9, 3.8453761047068872`*^9}, {
   3.8453787925904827`*^9, 3.84537879537341*^9}, {3.845379477103894*^9, 
   3.845379481513034*^9}, {3.845380094411549*^9, 3.845380095755999*^9}, 
   3.845380692592964*^9, {3.845382784875369*^9, 3.845382784989209*^9}, {
   3.8453837236176367`*^9, 3.8453837292851763`*^9}, 3.8453840901462917`*^9, {
   3.8453847238023233`*^9, 3.845384750130554*^9}, 3.845384934196032*^9, 
   3.845386511048645*^9, {3.8453868200358458`*^9, 3.8453868201331263`*^9}, {
   3.845387594128537*^9, 3.8453875973352547`*^9}, {3.84538937054486*^9, 
   3.8453893707212677`*^9}, 3.845394100651428*^9, {3.8453942633929157`*^9, 
   3.845394269942133*^9}, 3.845394568599805*^9, {3.845394747299581*^9, 
   3.845394747395973*^9}, 3.845396550316617*^9, {3.845396584421588*^9, 
   3.8453966234424667`*^9}, {3.845397124714779*^9, 3.8453971267746067`*^9}, 
   3.84539735809081*^9, {3.845398088537994*^9, 3.845398088811008*^9}, 
   3.845398502588813*^9, {3.8453986354820347`*^9, 3.845398638301716*^9}, 
   3.845399020309443*^9, {3.84539911260933*^9, 3.845399112696456*^9}, 
   3.8453994742589006`*^9, {3.8453995493083153`*^9, 3.845399549761314*^9}, {
   3.84539996273059*^9, 3.8453999638778954`*^9}, 3.8454003126101227`*^9, 
   3.845400446817849*^9, 3.84540065305075*^9, 3.8454007946740913`*^9, {
   3.845403258897007*^9, 3.845403259094369*^9}, {3.845403379435788*^9, 
   3.845403379520666*^9}, 3.84540455937351*^9, 3.845460390303298*^9, 
   3.8454622198365927`*^9, 3.845463411035866*^9, 3.845469465675424*^9, 
   3.845470341375732*^9, {3.845477259878932*^9, 3.8454772894729424`*^9}, {
   3.845477820087738*^9, 3.845477824259544*^9}, {3.8454788659655237`*^9, 
   3.845478871046484*^9}, {3.8454795282431498`*^9, 3.845479528594211*^9}, {
   3.845480946064417*^9, 3.845480946411735*^9}, {3.845481838003016*^9, 
   3.845481838244751*^9}, 3.84548204062394*^9, {3.845482449918721*^9, 
   3.8454824526457233`*^9}, {3.8454856398320932`*^9, 3.8454856467284603`*^9}, 
   3.845510314535274*^9, {3.845510750208535*^9, 3.8455108985858927`*^9}, 
   3.845512251851364*^9, {3.8455420317891197`*^9, 3.845542086235256*^9}, 
   3.845542568355424*^9, {3.8455433160664463`*^9, 3.8455433216870728`*^9}, {
   3.84554354455905*^9, 3.845543550010841*^9}, {3.845543794051914*^9, 
   3.845543800903819*^9}, {3.8455439071809397`*^9, 3.8455439123440943`*^9}, {
   3.845544837962225*^9, 3.8455448380459213`*^9}, {3.8455466991081533`*^9, 
   3.845546707142412*^9}, {3.8455473314535637`*^9, 3.8455474258190813`*^9}, {
   3.845547668277995*^9, 3.8455476867311993`*^9}, {3.845548882250566*^9, 
   3.845548891799768*^9}, 3.845549507219761*^9, 3.8455504003116503`*^9, 
   3.845550438539719*^9, {3.8455522988813047`*^9, 3.845552309940572*^9}, 
   3.8455535745182056`*^9, {3.8456339983424177`*^9, 3.8456340278154182`*^9}, 
   3.845634404951208*^9, {3.845634616948501*^9, 3.845634618063878*^9}, {
   3.845666864282341*^9, 3.845666905268319*^9}, 3.845669396158519*^9, {
   3.845718918103591*^9, 3.845718950171109*^9}, {3.845719914569866*^9, 
   3.8457199264639807`*^9}, {3.845720920180537*^9, 3.845720922307621*^9}, {
   3.845723466055427*^9, 3.8457234875431833`*^9}, 3.845725146116794*^9, {
   3.84572988028605*^9, 3.845729893018579*^9}, {3.845733899488557*^9, 
   3.845733900961162*^9}, 3.8457340563548326`*^9, {3.845734752706788*^9, 
   3.845734756190999*^9}, {3.845735351348439*^9, 3.845735358945818*^9}, {
   3.845735475104451*^9, 3.845735487397901*^9}, {3.8457361179403*^9, 
   3.845736119971333*^9}, 3.845736451232605*^9, {3.845772817389077*^9, 
   3.845772850261087*^9}, {3.845773856911923*^9, 3.8457738671594687`*^9}, 
   3.8457742454213953`*^9, 3.845775151713622*^9, {3.84577518517446*^9, 
   3.845775194676414*^9}, {3.845775564905182*^9, 3.845775568265974*^9}, {
   3.8457758989926243`*^9, 3.84577590411569*^9}, 3.845777017396832*^9, 
   3.84577724528966*^9, 3.845806348149075*^9, {3.8458064561091423`*^9, 
   3.84580645623592*^9}, 3.84582054406318*^9, 3.8458232348384933`*^9, {
   3.845828099627614*^9, 3.84582810397183*^9}, {3.8458519265895433`*^9, 
   3.845851947532864*^9}, {3.8458523600133*^9, 3.845852367555155*^9}, {
   3.8458572057582483`*^9, 3.845857209451457*^9}, {3.8458601131128902`*^9, 
   3.845860114304945*^9}, {3.845860460749896*^9, 3.845860478598433*^9}, {
   3.845860617673667*^9, 3.845860622398219*^9}, {3.845883838114304*^9, 
   3.845883838190744*^9}, 3.845884850265476*^9, {3.845899723293129*^9, 
   3.845899729817514*^9}, {3.845900004445265*^9, 3.845900021044262*^9}, {
   3.8459042537917643`*^9, 3.845904255515436*^9}, {3.845904832324946*^9, 
   3.845904836706017*^9}, {3.845922027908476*^9, 3.845922069525816*^9}, {
   3.8459344633891687`*^9, 3.845934473176676*^9}, 3.8459356479125547`*^9, 
   3.8459366029747458`*^9, {3.845979783954608*^9, 3.845979795637617*^9}, {
   3.846008142921769*^9, 3.84600814599763*^9}, 3.846015669703974*^9, {
   3.846017990389263*^9, 3.846017990400298*^9}, {3.846776554532737*^9, 
   3.846776567977831*^9}, {3.84677671315165*^9, 3.846776721940804*^9}, {
   3.846777409357435*^9, 3.846777439037518*^9}, {3.8467776175458508`*^9, 
   3.846777650074782*^9}, 3.846777736728574*^9, {3.850990507051817*^9, 
   3.850990521320304*^9}, 3.850990914518853*^9, {3.850990984122566*^9, 
   3.850990984275181*^9}, 3.850991302353074*^9, {3.851005567811549*^9, 
   3.8510055712513113`*^9}, 3.851006481424851*^9, {3.8510984381947947`*^9, 
   3.851098446830113*^9}, {3.851098484257711*^9, 3.851098492545776*^9}, 
   3.8510985557205753`*^9, {3.8511624704529037`*^9, 3.851162498775166*^9}, {
   3.851162778608416*^9, 3.851162803156255*^9}, {3.851162907230542*^9, 
   3.851162907705299*^9}, 3.851163011717169*^9, {3.851163066209427*^9, 
   3.85116307018864*^9}, 3.85116347753967*^9, {3.8511635511018667`*^9, 
   3.8511635623094273`*^9}, {3.851163705401779*^9, 3.8511637106493397`*^9}, {
   3.851163967420866*^9, 3.851163967836048*^9}, {3.851164172868635*^9, 
   3.851164176178014*^9}, {3.851166428624505*^9, 3.8511664452951813`*^9}, {
   3.8511677145514297`*^9, 3.85116772973032*^9}, {3.851168244889882*^9, 
   3.851168245590848*^9}, 3.851169073658041*^9, {3.8511696711888037`*^9, 
   3.851169671588922*^9}, {3.853499410971225*^9, 3.8534994136369658`*^9}, {
   3.8539501946110163`*^9, 3.853950194765171*^9}, {3.854099320734169*^9, 
   3.854099326130427*^9}, {3.854099497899685*^9, 3.854099513234441*^9}, 
   3.8540999549064493`*^9, {3.854100075474039*^9, 3.854100171888076*^9}, {
   3.85410043142177*^9, 3.854100432614698*^9}, {3.854100793136633*^9, 
   3.854100802170246*^9}, {3.85410083450183*^9, 3.854100834610186*^9}, 
   3.854100906300597*^9, 3.854105036660687*^9, {3.854106687617216*^9, 
   3.854106697883758*^9}, {3.854445447011832*^9, 3.854445499984994*^9}, {
   3.854448081007832*^9, 3.854448085984467*^9}, {3.854449321558072*^9, 
   3.8544493302860603`*^9}, {3.85447368633494*^9, 3.85447369007165*^9}, {
   3.8544750772530527`*^9, 3.854475080493394*^9}, {3.854476153105608*^9, 
   3.854476159523871*^9}, {3.854532244182086*^9, 3.854532248493373*^9}, 
   3.854532698051196*^9, 3.854534224562451*^9, 3.8545366998853416`*^9, 
   3.854538881128544*^9, 3.854540038741282*^9, 3.854541685124447*^9, 
   3.854553722912842*^9, 3.8545547472220097`*^9, {3.8546159578510513`*^9, 
   3.854615960265827*^9}, {3.854617058936112*^9, 3.854617064239244*^9}, 
   3.8546225783823433`*^9, 3.854623949708995*^9, 3.854624253972166*^9, 
   3.85463668937184*^9, {3.8546419067981863`*^9, 3.854641906908249*^9}, 
   3.8546430531571074`*^9, 3.854646449790228*^9, {3.854702894158869*^9, 
   3.854702898647691*^9}, 3.8547065085041227`*^9, {3.854707875304266*^9, 
   3.854707876274675*^9}, 3.8547130181552973`*^9, 3.854714246808654*^9, 
   3.854724993388075*^9, 3.854733298553906*^9, {3.854785270341319*^9, 
   3.8547852942578907`*^9}, {3.8547855400983067`*^9, 3.854785541025112*^9}, {
   3.8547887353449173`*^9, 3.854788762826858*^9}, {3.854791511301353*^9, 
   3.85479151525063*^9}, {3.8547920150621653`*^9, 3.8547920194040728`*^9}, {
   3.855047956741419*^9, 3.8550479843832693`*^9}, 3.855052257598361*^9, {
   3.855055073808415*^9, 3.855055074128663*^9}, {3.85505531600931*^9, 
   3.855055316082065*^9}, 3.855055692898889*^9, {3.85505589022523*^9, 
   3.855055891151684*^9}, {3.8550560893588467`*^9, 3.8550560966519623`*^9}, {
   3.855148318880033*^9, 3.855148320150077*^9}, {3.855154975206047*^9, 
   3.855154977413459*^9}, {3.855155053397197*^9, 3.855155054023333*^9}, {
   3.8551599747767763`*^9, 3.855159991390624*^9}, 3.855187920069433*^9, {
   3.85523989366357*^9, 3.85523990380121*^9}, {3.855247590295889*^9, 
   3.85524759993943*^9}, 3.855247764531158*^9, 3.855254707077674*^9, {
   3.855310708005664*^9, 3.855310711213787*^9}, {3.855311738312851*^9, 
   3.855311740805813*^9}, 3.855312826467784*^9, 3.855325389886937*^9, {
   3.855338751840206*^9, 3.8553387518497887`*^9}, 3.855340138745021*^9, 
   3.8553415886282997`*^9, 3.8553429702009563`*^9, 3.85535145644131*^9, 
   3.855396113261153*^9, 3.8554207668026247`*^9, {3.8554327317999067`*^9, 
   3.855432734418141*^9}, {3.8555226522559557`*^9, 3.855522655105702*^9}, {
   3.861272896330673*^9, 3.8612729027430058`*^9}, 3.8613574332511053`*^9, 
   3.8613574742411327`*^9, 3.861373426696055*^9, 3.861810082280422*^9, {
   3.8618131475796967`*^9, 3.8618131698780203`*^9}, 3.861815655211836*^9, 
   3.8618157721544437`*^9, 3.861873548359015*^9, {3.861876350566114*^9, 
   3.861876353062379*^9}, 3.86188691698158*^9, {3.8618904386332684`*^9, 
   3.861890438699481*^9}, 3.8618971540081797`*^9, 3.8619104181419563`*^9, {
   3.86191670092295*^9, 3.861916700961287*^9}, 3.8619574820358677`*^9, 
   3.8619578972220917`*^9, 3.861977664380062*^9, 3.861977829958987*^9, {
   3.861983804605852*^9, 3.86198381437387*^9}, {3.861984975409629*^9, 
   3.861984993775919*^9}, {3.862050582113213*^9, 3.862050595364005*^9}, {
   3.862476881431806*^9, 3.862476881536312*^9}, 3.8635498564256563`*^9, {
   3.863550870854823*^9, 3.863550910396307*^9}, 3.8635978463099194`*^9, {
   3.863598182397912*^9, 3.863598190270442*^9}, {3.8635983258264713`*^9, 
   3.86359832814491*^9}, 3.863598387062508*^9, 3.86361918953817*^9, 
   3.863706102070169*^9, 3.86370667656982*^9, {3.8637072236360207`*^9, 
   3.863707231290745*^9}, {3.8637076941267967`*^9, 3.863707695272702*^9}, {
   3.863708211663434*^9, 3.8637082130835037`*^9}, {3.8637087104006643`*^9, 
   3.863708711479844*^9}, {3.863708937375023*^9, 3.863708942992313*^9}, {
   3.863709891379531*^9, 3.863709905139497*^9}, {3.863709999196258*^9, 
   3.863710001908877*^9}, {3.863710052189063*^9, 3.863710063669538*^9}, {
   3.863711086776588*^9, 3.863711086960847*^9}, 3.86371113347409*^9, {
   3.863713334506444*^9, 3.863713352597397*^9}, {3.863713389476039*^9, 
   3.8637133896239758`*^9}, 3.863714414200577*^9, {3.863714487353479*^9, 
   3.8637144874959183`*^9}, 3.863714700096484*^9, {3.863714952005862*^9, 
   3.863714952130862*^9}, {3.863716847602275*^9, 3.8637168477755737`*^9}, 
   3.8637171215389013`*^9, 3.863718164062023*^9, {3.863718489367236*^9, 
   3.863718493152401*^9}, {3.863718761734376*^9, 3.863718764524254*^9}, {
   3.863718806407852*^9, 3.863718807010518*^9}, {3.863719539860918*^9, 
   3.863719546465582*^9}, {3.86376955747388*^9, 3.8637695598141403`*^9}, {
   3.86377356865514*^9, 3.863773571055416*^9}, 3.8638602416315727`*^9, {
   3.863874295756915*^9, 3.86387429726853*^9}, {3.863884699016305*^9, 
   3.863884700817925*^9}, {3.8638852312527246`*^9, 3.863885234513459*^9}, {
   3.864213828077104*^9, 3.8642138504750957`*^9}, {3.864214921208817*^9, 
   3.864214927349419*^9}, 3.864298436838125*^9, 3.8642986245130796`*^9, {
   3.8649922520791883`*^9, 3.8649922549983053`*^9}, {3.864993778275032*^9, 
   3.864993814387432*^9}, {3.8649988473549147`*^9, 3.86499884794245*^9}, 
   3.864999597647356*^9, {3.864999922667997*^9, 3.864999923974473*^9}, {
   3.8650005407503033`*^9, 3.865000542046081*^9}, {3.86500928165707*^9, 
   3.865009283210617*^9}, {3.865345818147499*^9, 3.865345821116542*^9}, {
   3.865419130863646*^9, 3.86541913709447*^9}, {3.86542161736415*^9, 
   3.865421623514044*^9}, {3.865421888396118*^9, 3.865421891361083*^9}, {
   3.865421947892705*^9, 3.865421952849555*^9}, {3.8654389239276867`*^9, 
   3.865438926454301*^9}, {3.865439005893091*^9, 3.865439008584065*^9}, {
   3.865450137565256*^9, 3.865450139204981*^9}, {3.865450344574107*^9, 
   3.86545034624646*^9}, {3.865497379421686*^9, 3.865497386722864*^9}, {
   3.865506649006497*^9, 3.865506655546296*^9}, {3.865507008168388*^9, 
   3.86550701314931*^9}, {3.865510003559155*^9, 3.865510006956059*^9}, {
   3.8655105352956667`*^9, 3.865510540882622*^9}, {3.8655112335737677`*^9, 
   3.86551123428265*^9}, 3.865511363438465*^9, {3.865511496809556*^9, 
   3.865511497919628*^9}, {3.865511701113881*^9, 3.865511704375434*^9}, {
   3.8655117570853577`*^9, 3.865511757244879*^9}, {3.865512242387883*^9, 
   3.865512254418377*^9}, {3.865517640718791*^9, 3.8655176428771152`*^9}, {
   3.865518129196974*^9, 3.865518132775367*^9}, {3.865519080042233*^9, 
   3.8655190830699577`*^9}, 3.8655191959836617`*^9, {3.8655194186088057`*^9, 
   3.8655194187194767`*^9}, {3.865519570631818*^9, 3.865519580947064*^9}, {
   3.8655196139236317`*^9, 3.865519614938486*^9}, 3.865520026301342*^9, {
   3.865529793899891*^9, 3.865529813957786*^9}, {3.865535227890623*^9, 
   3.865535230884951*^9}, {3.865536387503278*^9, 3.865536394460799*^9}, {
   3.8655839794969683`*^9, 3.865583987537607*^9}, {3.86558715640237*^9, 
   3.865587170178591*^9}, 3.86558741112888*^9, {3.865588228875992*^9, 
   3.865588229039997*^9}, 3.865588409708591*^9, {3.865593762287416*^9, 
   3.8655937643049603`*^9}, {3.8656024356823273`*^9, 3.865602441501288*^9}, {
   3.865602474737474*^9, 3.865602475231875*^9}, {3.866120196925111*^9, 
   3.86612021673785*^9}, {3.866120266087544*^9, 3.86612026730302*^9}, 
   3.866120327698739*^9, {3.866120529976769*^9, 3.866120530901843*^9}, 
   3.866121667439666*^9, {3.86612381566531*^9, 3.866123857035081*^9}, {
   3.8661241579644413`*^9, 3.866124176876491*^9}, {3.8661909399968863`*^9, 
   3.866190945346902*^9}, {3.866209947976056*^9, 3.866209985670021*^9}, {
   3.866210226471537*^9, 3.866210234268833*^9}, {3.86621517377628*^9, 
   3.866215180626154*^9}, 3.8662153987253523`*^9, 3.8662163247035427`*^9, 
   3.866216399525339*^9, 3.86621854082298*^9, {3.86622254984372*^9, 
   3.8662225574581537`*^9}, 3.866223714963975*^9, {3.866224648058709*^9, 
   3.866224648296446*^9}, 3.866228287489895*^9, 3.866274093172863*^9, {
   3.8662779796551456`*^9, 3.8662779831047173`*^9}, 3.866280123078924*^9, 
   3.866289416223378*^9, {3.866289979798893*^9, 3.866289980256996*^9}, {
   3.86629458153373*^9, 3.866294582999482*^9}, {3.8662991535488367`*^9, 
   3.8662991536299753`*^9}, {3.866304213867861*^9, 3.8663042139003067`*^9}, {
   3.866305325595355*^9, 3.8663053275780487`*^9}, {3.866535488723257*^9, 
   3.8665354888629627`*^9}, {3.86653613077682*^9, 3.8665361309260073`*^9}, {
   3.866536610341976*^9, 3.866536610553406*^9}, {3.866538080622509*^9, 
   3.866538094119775*^9}, {3.8665391861060457`*^9, 3.866539186497319*^9}, {
   3.866540234001492*^9, 3.866540269834159*^9}, {3.86654069309691*^9, 
   3.866540693244561*^9}, 3.866541556482946*^9, {3.866551025899425*^9, 
   3.866551025952456*^9}, {3.8665855742994423`*^9, 3.866585574311821*^9}, {
   3.867162428733755*^9, 3.8671624288507013`*^9}, {3.867165947411831*^9, 
   3.867165947532797*^9}, 3.867317640190954*^9, {3.8674169946172028`*^9, 
   3.867416994716956*^9}, 3.867501968530518*^9, {3.871998005551359*^9, 
   3.8719980077567873`*^9}, 3.872943698251274*^9, 3.8731051734666767`*^9, {
   3.873105716043888*^9, 3.8731057162833853`*^9}, 3.873195739870438*^9, 
   3.873230174523367*^9, 3.874524154881734*^9, {3.8745754980073967`*^9, 
   3.874575498151325*^9}, 3.874577139358477*^9, 3.874580570027052*^9, {
   3.8745811750541897`*^9, 3.874581175236602*^9}, 3.8745890270180073`*^9, 
   3.875280558930822*^9, 3.875312273824181*^9, {3.87582734610553*^9, 
   3.87582734627415*^9}, 3.87582791249074*^9, {3.875896171113071*^9, 
   3.875896172009226*^9}, {3.8758995844132223`*^9, 3.875899587629306*^9}, {
   3.875906562473854*^9, 3.8759065626154213`*^9}, {3.875954855414806*^9, 
   3.875954856064837*^9}, {3.875955570710454*^9, 3.875955571361586*^9}, 
   3.878647261552334*^9, {3.878649909210617*^9, 3.878649920462659*^9}, {
   3.8786500141443853`*^9, 3.8786500179202557`*^9}, 3.878650179505858*^9, {
   3.8786504216988487`*^9, 3.878650447820487*^9}, {3.8786505982289867`*^9, 
   3.878650630961873*^9}, {3.878651431680567*^9, 3.878651555891334*^9}, {
   3.878651669671736*^9, 3.878651717275072*^9}, {3.878651813735951*^9, 
   3.8786518673511963`*^9}, {3.878651910441655*^9, 3.8786521724428368`*^9}, {
   3.8786522785313272`*^9, 3.8786523468665667`*^9}, {3.87865240574079*^9, 
   3.878652493732451*^9}, {3.8786530452136793`*^9, 3.8786530705714483`*^9}, {
   3.878841040474708*^9, 3.8788410513437147`*^9}, {3.878841558206483*^9, 
   3.8788415591319304`*^9}, {3.878844596840703*^9, 3.878844596869623*^9}, 
   3.878903172523497*^9, 3.878903607904133*^9, {3.878907915975213*^9, 
   3.8789079161446257`*^9}, {3.878912277620202*^9, 3.8789122781313343`*^9}, 
   3.878920029549008*^9, 3.878925242619872*^9, {3.878925388908709*^9, 
   3.8789253896399927`*^9}, 3.8792468040173073`*^9, 3.879247084685145*^9, 
   3.8792479037112103`*^9, 3.879248257703446*^9, 3.879248453631956*^9, {
   3.879248698424008*^9, 3.8792487273607893`*^9}, 3.8792510950550003`*^9, 
   3.8792522176385717`*^9, {3.879252456737063*^9, 3.879252459910338*^9}, 
   3.879255120153013*^9, 3.879256050226903*^9, 3.879262187382983*^9, 
   3.8792630862180233`*^9, 3.8792647268315487`*^9, {3.879342657904155*^9, 
   3.879342691350038*^9}, 3.879342763446353*^9, 3.879342808171959*^9, 
   3.879342963209519*^9, {3.879343010450186*^9, 3.879343011245919*^9}, 
   3.879343698279169*^9, 3.879353726424925*^9, {3.879611259433186*^9, 
   3.879611290607493*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"225c6829-52e8-4c58-bc8b-9bb1dc88e975"],

Cell["\<\
Mais ils varient dans leur unary features et dans leur regularization learning\
\>", "Text",
 CellChangeTimes->{{3.880561658202935*^9, 
  3.880561678177803*^9}},ExpressionUUID->"3493686d-47b8-4d61-b118-\
859e8bd2a1e5"],

Cell[CellGroupData[{

Cell["Model demo", "Subtitle",
 CellChangeTimes->{{3.880561687722858*^9, 
  3.8805616907756987`*^9}},ExpressionUUID->"42ec54e8-aa26-444b-9ea9-\
11cc94b75cba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"featureEncoder", "[", "features_", "]"}], ":=", 
  RowBox[{"NetInsertSharedArrays", "[", 
   RowBox[{
    RowBox[{"NetGraph", "@", 
     RowBox[{"FunctionLayer", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "conv1", ",", "conv2", ",", "conv3", ",", "conv4", ",", "upconv3", 
           ",", "upconv2", ",", "upconv1"}], "}"}], ",", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"conv1", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "#Input", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"conv2", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv1", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"conv3", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv2", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{"\"\<Output\>\"", "->", "conv3"}], "|>"}]}], 
          "\[IndentingNewLine]", ")"}]}], "]"}], "&"}], "]"}]}], ",", 
    "\"\<featureNet\>\""}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.879341604102272*^9, 3.879341606923513*^9}, {
   3.8793416482042837`*^9, 3.8793417309464006`*^9}, {3.87934179688118*^9, 
   3.8793419019192047`*^9}, {3.879341963951344*^9, 3.879342312163074*^9}, {
   3.879342344437942*^9, 3.879342352231041*^9}, {3.879342419384132*^9, 
   3.87934253958526*^9}, {3.879342599153838*^9, 3.879342607487556*^9}, {
   3.879342854263424*^9, 3.879342945538087*^9}, {3.879343400089707*^9, 
   3.879343468337978*^9}, {3.879343501156274*^9, 3.879343602283358*^9}, {
   3.8793489668687067`*^9, 3.879348967085766*^9}, {3.8793526189412317`*^9, 
   3.87935263388126*^9}, 3.879352891507119*^9},
 CellLabel->"In[86]:=",ExpressionUUID->"686ce73a-0be0-4ccc-a0c2-0fd0f31839d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stereoMatcher", "[", "features_", "]"}], ":=", 
  RowBox[{"NetGraph", "@", 
   RowBox[{"FunctionLayer", "[", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "conv1", ",", "conv2", ",", "conv3", ",", "conv4", ",", "out"}], 
        "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"conv1", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "#Input", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv2", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "conv1", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv3", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "conv2", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv4", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "conv3", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"out", "=", 
          RowBox[{
           RowBox[{"NetDelete", "[", 
            RowBox[{
             RowBox[{"conv3d", "[", "1", "]"}], ",", "\"\<3\>\""}], "]"}], 
           "[", "conv4", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"<|", 
          RowBox[{"\"\<Output\>\"", "->", "out"}], "|>"}]}], 
        "\[IndentingNewLine]", ")"}]}], "]"}], "&"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.879353140520178*^9, 3.879353224026003*^9}, {
  3.879354431508976*^9, 3.8793544492554092`*^9}, {3.880561706368649*^9, 
  3.880561707039936*^9}},ExpressionUUID->"8f61821c-5e26-4652-a808-\
7ea1855b6ec2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Model demo +1 convolution", "Subtitle",
 CellChangeTimes->{{3.8805617421375113`*^9, 
  3.880561748888446*^9}},ExpressionUUID->"6be80f84-829b-479e-996f-\
3fd8ba935e3a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"featureEncoder", "[", "features_", "]"}], ":=", 
  RowBox[{"NetInsertSharedArrays", "[", 
   RowBox[{
    RowBox[{"NetGraph", "@", 
     RowBox[{"FunctionLayer", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "conv1", ",", "conv2", ",", "conv3", ",", "conv4", ",", "upconv3", 
           ",", "upconv2", ",", "upconv1"}], "}"}], ",", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"conv1", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "#Input", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"conv2", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv1", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"conv3", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv2", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"conv4", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv3", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{"\"\<Output\>\"", "->", "conv4"}], "|>"}]}], 
          "\[IndentingNewLine]", ")"}]}], "]"}], "&"}], "]"}]}], ",", 
    "\"\<featureNet\>\""}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.879341604102272*^9, 3.879341606923513*^9}, {
   3.8793416482042837`*^9, 3.8793417309464006`*^9}, {3.87934179688118*^9, 
   3.8793419019192047`*^9}, {3.879341963951344*^9, 3.879342312163074*^9}, {
   3.879342344437942*^9, 3.879342352231041*^9}, {3.879342419384132*^9, 
   3.87934253958526*^9}, {3.879342599153838*^9, 3.879342607487556*^9}, {
   3.879342854263424*^9, 3.879342945538087*^9}, {3.879343400089707*^9, 
   3.879343468337978*^9}, {3.879343501156274*^9, 3.879343602283358*^9}, {
   3.8793489668687067`*^9, 3.879348967085766*^9}, {3.8793526189412317`*^9, 
   3.87935263388126*^9}, 3.879352891507119*^9, {3.879684605617556*^9, 
   3.8796846115942793`*^9}, {3.879696664922615*^9, 3.8796966649886017`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"63e85c5e-e28e-4d5d-919e-e44f51076aaf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stereoMatcher", "[", "features_", "]"}], ":=", 
  RowBox[{"NetGraph", "@", 
   RowBox[{"FunctionLayer", "[", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "conv1", ",", "conv2", ",", "conv3", ",", "conv4", ",", "out"}], 
        "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"conv1", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "#Input", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv2", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "conv1", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv3", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "conv2", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv4", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "conv3", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"out", "=", 
          RowBox[{
           RowBox[{"NetDelete", "[", 
            RowBox[{
             RowBox[{"conv3d", "[", "1", "]"}], ",", "\"\<3\>\""}], "]"}], 
           "[", "conv4", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"<|", 
          RowBox[{"\"\<Output\>\"", "->", "out"}], "|>"}]}], 
        "\[IndentingNewLine]", ")"}]}], "]"}], "&"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.879353140520178*^9, 3.879353224026003*^9}, {
  3.879354431508976*^9, 3.8793544492554092`*^9}, {3.879684541353798*^9, 
  3.879684541740168*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"fd96fc62-37b5-4da4-83fa-4b99f4591af0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Full Unary Features, 3D reduites, sans ResNet", "Subtitle",
 CellChangeTimes->{{3.880561772154332*^9, 
  3.880561790601255*^9}},ExpressionUUID->"f04ff4ba-dca3-4cd8-9c22-\
547da685cbe0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"featureEncoder", "[", "features_", "]"}], ":=", 
  RowBox[{"NetInsertSharedArrays", "[", 
   RowBox[{
    RowBox[{"NetGraph", "@", 
     RowBox[{"FunctionLayer", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "conv1", ",", "conv2", ",", "conv3", ",", "conv4", ",", "conv5", 
           ",", " ", "conv6", ",", " ", "conv7", ",", " ", "conv8", ",", " ", 
           "conv9", ",", " ", "conv10", ",", " ", "conv11", ",", " ", 
           "conv12", ",", " ", "conv13", ",", " ", "conv14", ",", " ", 
           "conv15", ",", " ", "conv16", ",", " ", "conv17"}], "}"}], ",", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"conv1", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "#Input", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"conv2", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv1", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"conv3", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv2", "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv4", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv3", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"conv5", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv4", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"conv6", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv5", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"conv7", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv6", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"conv8", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv7", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"conv9", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv8", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"conv10", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv9", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"conv11", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv10", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"conv12", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv11", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"conv13", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv12", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"conv14", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv13", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"conv15", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv14", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"conv16", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv15", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"conv17", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv16", "]"}]}],
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"No", " ", "relu"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"conv18", " ", "=", " ", 
            RowBox[{
             RowBox[{"NetChain", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"PaddingLayer", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
                  RowBox[{"Padding", "->", "\"\<Fixed\>\""}]}], "]"}], ",", 
                RowBox[{"ConvolutionLayer", "[", 
                 RowBox[{"32", ",", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], "}"}], "]"}], 
             "[", "conv17", "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{"\"\<Output\>\"", "->", "conv17"}], "|>"}]}], 
          "\[IndentingNewLine]", ")"}]}], "]"}], "&"}], "]"}]}], ",", 
    "\"\<featureNet\>\""}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.879341604102272*^9, 3.879341606923513*^9}, {
   3.8793416482042837`*^9, 3.8793417309464006`*^9}, {3.87934179688118*^9, 
   3.8793419019192047`*^9}, {3.879341963951344*^9, 3.879342312163074*^9}, {
   3.879342344437942*^9, 3.879342352231041*^9}, {3.879342419384132*^9, 
   3.87934253958526*^9}, {3.879342599153838*^9, 3.879342607487556*^9}, {
   3.879342854263424*^9, 3.879342945538087*^9}, {3.879343400089707*^9, 
   3.879343468337978*^9}, {3.879343501156274*^9, 3.879343602283358*^9}, {
   3.8793489668687067`*^9, 3.879348967085766*^9}, {3.8793526189412317`*^9, 
   3.87935263388126*^9}, 3.879352891507119*^9, {3.879684605617556*^9, 
   3.8796846115942793`*^9}, {3.879696664922615*^9, 3.8796966649886017`*^9}, {
   3.8803986922123013`*^9, 3.8803987040251493`*^9}, 3.8803992041006193`*^9, {
   3.880399373242453*^9, 3.880399400616716*^9}, {3.880399435793213*^9, 
   3.8803995060658493`*^9}, {3.880399566247752*^9, 3.8803996182884693`*^9}, {
   3.880399653614341*^9, 3.880399655201597*^9}, {3.8803999440968924`*^9, 
   3.88039995765034*^9}, {3.88039999147721*^9, 3.880399995377173*^9}, {
   3.880400166054975*^9, 3.880400195651675*^9}, {3.8804003245220747`*^9, 
   3.880400336993403*^9}, {3.880400443291854*^9, 3.880400469014565*^9}, {
   3.880400567639038*^9, 3.880400569941486*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"ae5549d3-33af-4aa2-b7dd-0846601c7bc9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stereoMatcher", "[", "features_", "]"}], ":=", 
  RowBox[{"NetGraph", "@", 
   RowBox[{"FunctionLayer", "[", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "conv1", ",", "conv2", ",", "conv3", ",", "conv4", ",", "out"}], 
        "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"conv1", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "#Input", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv2", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "conv1", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv3", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "conv2", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv4", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "conv3", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"out", "=", 
          RowBox[{
           RowBox[{"NetDelete", "[", 
            RowBox[{
             RowBox[{"conv3d", "[", "1", "]"}], ",", "\"\<3\>\""}], "]"}], 
           "[", "conv4", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"<|", 
          RowBox[{"\"\<Output\>\"", "->", "out"}], "|>"}]}], 
        "\[IndentingNewLine]", ")"}]}], "]"}], "&"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.879353140520178*^9, 3.879353224026003*^9}, {
  3.879354431508976*^9, 3.8793544492554092`*^9}, {3.879684541353798*^9, 
  3.879684541740168*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"45e857f8-01c2-44dc-b298-9b3bcaa64f7c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Full 3D and ResNet pour features", "Subtitle",
 CellChangeTimes->{{3.880561884587976*^9, 
  3.880561891067183*^9}},ExpressionUUID->"4fee181d-bfb0-45ea-b9f2-\
c0e8a88665d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"featureEncoder", "[", "features_", "]"}], ":=", 
  RowBox[{"NetInsertSharedArrays", "[", 
   RowBox[{
    RowBox[{"NetGraph", "@", 
     RowBox[{"FunctionLayer", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "conv1", ",", "conv2", ",", "conv3", ",", "conv4", ",", "conv5", 
           ",", " ", "conv6", ",", " ", "conv7", ",", " ", "conv8", ",", " ", 
           "conv9", ",", " ", "conv10", ",", " ", "conv11", ",", " ", 
           "conv12", ",", " ", "conv13", ",", " ", "conv14", ",", " ", 
           "conv15", ",", " ", "conv16", ",", " ", "conv17", ",", "conv18", 
           ",", " ", "residual1", ",", " ", "residual2", ",", " ", 
           "residual3", ",", " ", "residual4", ",", "residual5", ",", 
           "residual6", ",", "residual7", ",", "residual8"}], "}"}], ",", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"conv1", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "#Input", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"conv2", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv1", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"conv3", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv2", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"residual1", "=", 
            RowBox[{"conv1", "+", "conv3"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"conv4", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "residual1", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"conv5", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv4", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"residual2", "=", 
            RowBox[{"residual1", "+", "conv5"}]}], ";", "\[IndentingNewLine]",
            "\[IndentingNewLine]", 
           RowBox[{"conv6", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "residual2", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"conv7", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv6", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"residual3", "=", 
            RowBox[{"residual2", "+", "conv7"}]}], ";", "\[IndentingNewLine]",
            "\[IndentingNewLine]", 
           RowBox[{"conv8", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "residual3", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"conv9", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv8", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"residual4", "=", 
            RowBox[{"residual3", "+", "conv9"}]}], ";", "\[IndentingNewLine]",
            "\[IndentingNewLine]", 
           RowBox[{"conv10", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "residual4", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"conv11", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv10", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"residual5", "=", 
            RowBox[{"residual4", "+", "conv11"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv12", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "residual5", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"conv13", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv12", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"residual6", "=", 
            RowBox[{"residual5", "+", "conv13"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv14", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "residual6", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"conv15", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv14", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"residual7", "=", 
            RowBox[{"residual6", "+", "conv15"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv16", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "residual7", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"conv17", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv16", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"residual8", "=", 
            RowBox[{"residual7", "+", "conv17"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"No", " ", "relu"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"conv18", " ", "=", 
            RowBox[{
             RowBox[{"ConvolutionLayer", "[", 
              RowBox[{"features", ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "3"}], "}"}], ",", 
               RowBox[{"PaddingSize", "->", "1"}]}], "]"}], "[", "residual8", 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{"\"\<Output\>\"", "->", "conv18"}], "|>"}]}], 
          "\[IndentingNewLine]", ")"}]}], "]"}], "&"}], "]"}]}], ",", 
    "\"\<featureNet\>\""}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.879341604102272*^9, 3.879341606923513*^9}, {
   3.8793416482042837`*^9, 3.8793417309464006`*^9}, {3.87934179688118*^9, 
   3.8793419019192047`*^9}, {3.879341963951344*^9, 3.879342312163074*^9}, {
   3.879342344437942*^9, 3.879342352231041*^9}, {3.879342419384132*^9, 
   3.87934253958526*^9}, {3.879342599153838*^9, 3.879342607487556*^9}, {
   3.879342854263424*^9, 3.879342945538087*^9}, {3.879343400089707*^9, 
   3.879343468337978*^9}, {3.879343501156274*^9, 3.879343602283358*^9}, {
   3.8793489668687067`*^9, 3.879348967085766*^9}, {3.8793526189412317`*^9, 
   3.87935263388126*^9}, 3.879352891507119*^9, {3.879684605617556*^9, 
   3.8796846115942793`*^9}, {3.879696664922615*^9, 3.8796966649886017`*^9}, {
   3.8803986922123013`*^9, 3.8803987040251493`*^9}, 3.8803992041006193`*^9, {
   3.880399373242453*^9, 3.880399400616716*^9}, {3.880399435793213*^9, 
   3.8803995060658493`*^9}, {3.880399566247752*^9, 3.8803996182884693`*^9}, {
   3.880399653614341*^9, 3.880399655201597*^9}, {3.8803999440968924`*^9, 
   3.88039995765034*^9}, {3.88039999147721*^9, 3.880399995377173*^9}, {
   3.880400166054975*^9, 3.880400195651675*^9}, {3.8804003245220747`*^9, 
   3.880400336993403*^9}, {3.880400443291854*^9, 3.880400469014565*^9}, {
   3.880400567639038*^9, 3.880400569941486*^9}, {3.880408485344247*^9, 
   3.880408493556411*^9}, {3.880408570266678*^9, 3.8804087845421963`*^9}, {
   3.8804090940485907`*^9, 3.880409095074349*^9}, 3.880409181505241*^9, 
   3.8804092222790003`*^9, {3.880444442741788*^9, 3.8804444476792517`*^9}, 
   3.8804445526632957`*^9, {3.880446053404434*^9, 3.880446055508847*^9}, {
   3.880446101508526*^9, 3.8804461016053047`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"261c881e-4cf8-4273-a01b-5c77e106e77e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stereoMatcher", "[", "features_", "]"}], ":=", 
  RowBox[{"NetGraph", "@", 
   RowBox[{"FunctionLayer", "[", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "conv19", ",", "conv20", ",", "conv21", ",", "conv22", ",", "conv23", 
         ",", "conv24", ",", "conv25", ",", "conv26", ",", "conv27", ",", 
         "conv28", ",", "conv29", ",", "conv30", ",", "conv31", ",", "conv32",
          ",", "conv33", ",", "conv34", ",", "conv35", ",", "conv36", ",", 
         "conv37", ",", "out"}], "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"conv19", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "#Input", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv20", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "conv19", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv21", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv20", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv22", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv21", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv23", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv22", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv24", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv23", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv25", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv24", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv26", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv25", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv27", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv26", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv28", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv27", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv29", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv28", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv30", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "4"}], "]"}], "[", "conv29", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv31", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "4"}], "]"}], "[", "conv30", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv32", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "4"}], "]"}], "[", "conv31", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv33", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv32", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv34", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv33", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv35", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv34", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv36", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "conv35", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv37", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "conv36", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "Transposed", " ", "convolutions", "\[IndentingNewLine]", 
             "conv33"}], "=", 
            RowBox[{
             RowBox[{"upconv3d", "[", 
              RowBox[{"features", "*", "2"}], "]"}], "[", "conv20", "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv34", "=", 
            RowBox[{
             RowBox[{"upconv3d", "[", 
              RowBox[{"features", "*", "2"}], "]"}], "[", "conv21", "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv35", "=", 
            RowBox[{
             RowBox[{"upconv3d", "[", 
              RowBox[{"features", "*", "2"}], "]"}], "[", "conv19", "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv36", "=", 
            RowBox[{
             RowBox[{"upconv3d", "[", "features", "]"}], "[", "conv20", 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv37", "=", 
            RowBox[{
             RowBox[{"conv3d", "[", "features", "]"}], "[", "conv21", "]"}]}],
            ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"out", "=", 
          RowBox[{
           RowBox[{"NetDelete", "[", 
            RowBox[{
             RowBox[{"conv3d", "[", "1", "]"}], ",", "\"\<3\>\""}], "]"}], 
           "[", "conv37", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"<|", 
          RowBox[{"\"\<Output\>\"", "->", "out"}], "|>"}]}], 
        "\[IndentingNewLine]", ")"}]}], "]"}], "&"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.879353140520178*^9, 3.879353224026003*^9}, {
  3.879354431508976*^9, 3.8793544492554092`*^9}, {3.879684541353798*^9, 
  3.879684541740168*^9}, {3.880402138841156*^9, 3.8804023119709044`*^9}, {
  3.88040235408082*^9, 3.880402459967163*^9}, {3.880402501970334*^9, 
  3.8804025710912647`*^9}, {3.880402724276569*^9, 3.880402725109329*^9}, {
  3.880402782729267*^9, 3.880402972241643*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"78502e2f-5670-4d41-b355-3c66eb4e499a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Idem mais reduit", "Subtitle",
 CellChangeTimes->{{3.880561927862158*^9, 
  3.880561933643312*^9}},ExpressionUUID->"f870e77a-1c43-4eea-982e-\
c0953ff3ec10"],

Cell[BoxData[
 RowBox[{
  RowBox[{"featureEncoder", "[", "features_", "]"}], ":=", 
  RowBox[{"NetInsertSharedArrays", "[", 
   RowBox[{
    RowBox[{"NetGraph", "@", 
     RowBox[{"FunctionLayer", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "conv1", ",", "conv2", ",", "conv3", ",", "conv4", ",", " ", 
           "residual"}], "}"}], ",", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"conv1", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "#Input", "]"}]}],
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv2", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv1", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"conv3", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv2", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"residual", "=", 
            RowBox[{"conv1", "+", "conv3"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"No", " ", "relu"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"conv4", " ", "=", 
            RowBox[{
             RowBox[{"ConvolutionLayer", "[", 
              RowBox[{"features", ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "3"}], "}"}], ",", 
               RowBox[{"PaddingSize", "->", "1"}]}], "]"}], "[", "residual", 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{"\"\<Output\>\"", "->", "conv4"}], "|>"}]}], 
          "\[IndentingNewLine]", ")"}]}], "]"}], "&"}], "]"}]}], ",", 
    "\"\<featureNet\>\""}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.879341604102272*^9, 3.879341606923513*^9}, {
   3.8793416482042837`*^9, 3.8793417309464006`*^9}, {3.87934179688118*^9, 
   3.8793419019192047`*^9}, {3.879341963951344*^9, 3.879342312163074*^9}, {
   3.879342344437942*^9, 3.879342352231041*^9}, {3.879342419384132*^9, 
   3.87934253958526*^9}, {3.879342599153838*^9, 3.879342607487556*^9}, {
   3.879342854263424*^9, 3.879342945538087*^9}, {3.879343400089707*^9, 
   3.879343468337978*^9}, {3.879343501156274*^9, 3.879343602283358*^9}, {
   3.8793489668687067`*^9, 3.879348967085766*^9}, {3.8793526189412317`*^9, 
   3.87935263388126*^9}, 3.879352891507119*^9, {3.879684605617556*^9, 
   3.8796846115942793`*^9}, {3.879696664922615*^9, 3.8796966649886017`*^9}, {
   3.8803986922123013`*^9, 3.8803987040251493`*^9}, 3.8803992041006193`*^9, {
   3.880399373242453*^9, 3.880399400616716*^9}, {3.880399435793213*^9, 
   3.8803995060658493`*^9}, {3.880399566247752*^9, 3.8803996182884693`*^9}, {
   3.880399653614341*^9, 3.880399655201597*^9}, {3.8803999440968924`*^9, 
   3.88039995765034*^9}, {3.88039999147721*^9, 3.880399995377173*^9}, {
   3.880400166054975*^9, 3.880400195651675*^9}, {3.8804003245220747`*^9, 
   3.880400336993403*^9}, {3.880400443291854*^9, 3.880400469014565*^9}, {
   3.880400567639038*^9, 3.880400569941486*^9}, {3.880408485344247*^9, 
   3.880408493556411*^9}, {3.880408570266678*^9, 3.8804087845421963`*^9}, {
   3.8804090940485907`*^9, 3.880409095074349*^9}, 3.880409181505241*^9, 
   3.8804092222790003`*^9, {3.880444442741788*^9, 3.8804444476792517`*^9}, 
   3.8804445526632957`*^9, {3.880446053404434*^9, 3.880446055508847*^9}, {
   3.880446101508526*^9, 3.8804461016053047`*^9}, {3.8804679171496162`*^9, 
   3.880467945513999*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"f2197a3c-fb31-47f4-bcec-9e1afc2f0a22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stereoMatcher", "[", "features_", "]"}], ":=", 
  RowBox[{"NetGraph", "@", 
   RowBox[{"FunctionLayer", "[", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "conv19", ",", "conv20", ",", "conv21", ",", "conv22", ",", "conv23", 
         ",", "conv24", ",", "out"}], "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"conv19", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "#Input", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv20", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "conv19", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv21", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv20", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv22", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "4"}], "]"}], "[", "conv21", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv23", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv22", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv24", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "conv23", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"out", "=", 
          RowBox[{
           RowBox[{"NetDelete", "[", 
            RowBox[{
             RowBox[{"conv3d", "[", "1", "]"}], ",", "\"\<3\>\""}], "]"}], 
           "[", "conv24", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"<|", 
          RowBox[{"\"\<Output\>\"", "->", "out"}], "|>"}]}], 
        "\[IndentingNewLine]", ")"}]}], "]"}], "&"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.879353140520178*^9, 3.879353224026003*^9}, {
  3.879354431508976*^9, 3.8793544492554092`*^9}, {3.879684541353798*^9, 
  3.879684541740168*^9}, {3.880402138841156*^9, 3.8804023119709044`*^9}, {
  3.88040235408082*^9, 3.880402459967163*^9}, {3.880402501970334*^9, 
  3.8804025710912647`*^9}, {3.880402724276569*^9, 3.880402725109329*^9}, {
  3.880402782729267*^9, 3.880402972241643*^9}, {3.8804679696589003`*^9, 
  3.880468060769203*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"c7a7411d-f334-4041-b18f-cc63bbf863c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Le plus proche de GC - Net que j' ai pu faire", "Subtitle",
 CellChangeTimes->{{3.880561967153104*^9, 
  3.880561978763611*^9}},ExpressionUUID->"4ad34e00-98c2-4803-bcde-\
dafe798beb36"],

Cell[BoxData[
 RowBox[{
  RowBox[{"featureEncoder", "[", "features_", "]"}], ":=", 
  RowBox[{"NetInsertSharedArrays", "[", 
   RowBox[{
    RowBox[{"NetGraph", "@", 
     RowBox[{"FunctionLayer", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "conv1", ",", "conv2", ",", "conv3", ",", "conv4", ",", "conv5", 
           ",", " ", "conv6", ",", " ", "conv7", ",", " ", "conv8", ",", " ", 
           "conv9", ",", " ", "conv10", ",", " ", "conv11", ",", " ", 
           "conv12", ",", " ", "conv13", ",", " ", "conv14", ",", " ", 
           "conv15", ",", " ", "conv16", ",", " ", "conv17", ",", "conv18", 
           ",", " ", "residual1", ",", " ", "residual2", ",", " ", 
           "residual3", ",", " ", "residual4", ",", "residual5", ",", 
           "residual6", ",", "residual7", ",", "residual8"}], "}"}], ",", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"conv1", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "#Input", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"conv2", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv1", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"conv3", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv2", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"residual1", "=", 
            RowBox[{"conv1", "+", "conv3"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"conv4", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "residual1", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"conv5", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv4", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"residual2", "=", 
            RowBox[{"residual1", "+", "conv5"}]}], ";", "\[IndentingNewLine]",
            "\[IndentingNewLine]", 
           RowBox[{"conv6", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "residual2", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"conv7", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv6", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"residual3", "=", 
            RowBox[{"residual2", "+", "conv7"}]}], ";", "\[IndentingNewLine]",
            "\[IndentingNewLine]", 
           RowBox[{"conv8", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "residual3", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"conv9", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv8", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"residual4", "=", 
            RowBox[{"residual3", "+", "conv9"}]}], ";", "\[IndentingNewLine]",
            "\[IndentingNewLine]", 
           RowBox[{"conv10", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "residual4", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"conv11", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv10", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"residual5", "=", 
            RowBox[{"residual4", "+", "conv11"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv12", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "residual5", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"conv13", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv12", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"residual6", "=", 
            RowBox[{"residual5", "+", "conv13"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv14", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "residual6", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"conv15", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv14", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"residual7", "=", 
            RowBox[{"residual6", "+", "conv15"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv16", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "residual7", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"conv17", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv16", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"residual8", "=", 
            RowBox[{"residual7", "+", "conv17"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"No", " ", "relu"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"conv18", " ", "=", 
            RowBox[{
             RowBox[{"ConvolutionLayer", "[", 
              RowBox[{"features", ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "3"}], "}"}], ",", 
               RowBox[{"PaddingSize", "->", "1"}]}], "]"}], "[", "residual8", 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{"\"\<Output\>\"", "->", "conv18"}], "|>"}]}], 
          "\[IndentingNewLine]", ")"}]}], "]"}], "&"}], "]"}]}], ",", 
    "\"\<featureNet\>\""}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.879341604102272*^9, 3.879341606923513*^9}, {
   3.8793416482042837`*^9, 3.8793417309464006`*^9}, {3.87934179688118*^9, 
   3.8793419019192047`*^9}, {3.879341963951344*^9, 3.879342312163074*^9}, {
   3.879342344437942*^9, 3.879342352231041*^9}, {3.879342419384132*^9, 
   3.87934253958526*^9}, {3.879342599153838*^9, 3.879342607487556*^9}, {
   3.879342854263424*^9, 3.879342945538087*^9}, {3.879343400089707*^9, 
   3.879343468337978*^9}, {3.879343501156274*^9, 3.879343602283358*^9}, {
   3.8793489668687067`*^9, 3.879348967085766*^9}, {3.8793526189412317`*^9, 
   3.87935263388126*^9}, 3.879352891507119*^9, {3.879684605617556*^9, 
   3.8796846115942793`*^9}, {3.879696664922615*^9, 3.8796966649886017`*^9}, {
   3.8803986922123013`*^9, 3.8803987040251493`*^9}, 3.8803992041006193`*^9, {
   3.880399373242453*^9, 3.880399400616716*^9}, {3.880399435793213*^9, 
   3.8803995060658493`*^9}, {3.880399566247752*^9, 3.8803996182884693`*^9}, {
   3.880399653614341*^9, 3.880399655201597*^9}, {3.8803999440968924`*^9, 
   3.88039995765034*^9}, {3.88039999147721*^9, 3.880399995377173*^9}, {
   3.880400166054975*^9, 3.880400195651675*^9}, {3.8804003245220747`*^9, 
   3.880400336993403*^9}, {3.880400443291854*^9, 3.880400469014565*^9}, {
   3.880400567639038*^9, 3.880400569941486*^9}, {3.880408485344247*^9, 
   3.880408493556411*^9}, {3.880408570266678*^9, 3.8804087845421963`*^9}, {
   3.8804090940485907`*^9, 3.880409095074349*^9}, 3.880409181505241*^9, 
   3.8804092222790003`*^9, {3.880444442741788*^9, 3.8804444476792517`*^9}, 
   3.8804445526632957`*^9, {3.880446053404434*^9, 3.880446055508847*^9}, {
   3.880446101508526*^9, 3.8804461016053047`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"102b21d0-aa13-4fc1-961d-722a228d02af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stereoMatcher", "[", "features_", "]"}], ":=", 
  RowBox[{"NetGraph", "@", 
   RowBox[{"FunctionLayer", "[", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "conv19", ",", "conv20", ",", "conv21", ",", "conv22", ",", "conv23", 
         ",", "conv24", ",", "conv25", ",", "conv26", ",", "conv27", ",", 
         "conv28", ",", "conv29", ",", "conv30", ",", "conv31", ",", "conv32",
          ",", "conv33", ",", "conv34", ",", "conv35", ",", "conv36", ",", 
         "conv37", ",", "residual1", ",", " ", "residual2", ",", "residual3", 
         ",", "residual4", ",", "residual5", ",", "residual6", ",", 
         "residual7", ",", " ", "out"}], "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"conv19", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "#Input", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv20", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "conv19", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv21", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv20", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv22", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv21", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv23", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv22", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"residual1", "=", 
          RowBox[{"conv21", "+", "conv23"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"conv24", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "residual1", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv25", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv24", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv26", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv25", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"residual2", "=", 
          RowBox[{"conv24", "+", "conv26"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"conv27", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "residual2", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv28", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv27", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv29", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv28", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"residual3", "=", 
          RowBox[{"conv27", "+", "conv29"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"conv30", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "4"}], "]"}], "[", "residual3", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv31", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "4"}], "]"}], "[", "conv30", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv32", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "4"}], "]"}], "[", "conv31", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv33", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv32", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"residual4", "=", 
          RowBox[{"conv33", "+", "conv29"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"conv34", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "residual4", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"residual5", "=", 
          RowBox[{"conv34", "+", "conv26"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"conv35", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "residual5", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"residual6", "=", 
          RowBox[{"conv35", "+", "conv23"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"conv36", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "residual6", 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"residual7", "=", 
          RowBox[{"conv36", "+", "conv20"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"conv37", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "residual7", 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "Transposed", " ", "convolutions", "\[IndentingNewLine]", 
             "conv33"}], "=", 
            RowBox[{
             RowBox[{"upconv3d", "[", 
              RowBox[{"features", "*", "2"}], "]"}], "[", "conv20", "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv34", "=", 
            RowBox[{
             RowBox[{"upconv3d", "[", 
              RowBox[{"features", "*", "2"}], "]"}], "[", "conv21", "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv35", "=", 
            RowBox[{
             RowBox[{"upconv3d", "[", 
              RowBox[{"features", "*", "2"}], "]"}], "[", "conv19", "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv36", "=", 
            RowBox[{
             RowBox[{"upconv3d", "[", "features", "]"}], "[", "conv20", 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv37", "=", 
            RowBox[{
             RowBox[{"conv3d", "[", "features", "]"}], "[", "conv21", "]"}]}],
            ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"out", "=", 
          RowBox[{
           RowBox[{"NetDelete", "[", 
            RowBox[{
             RowBox[{"conv3d", "[", "1", "]"}], ",", "\"\<3\>\""}], "]"}], 
           "[", "conv37", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"<|", 
          RowBox[{"\"\<Output\>\"", "->", "out"}], "|>"}]}], 
        "\[IndentingNewLine]", ")"}]}], "]"}], "&"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.879353140520178*^9, 3.879353224026003*^9}, {
   3.879354431508976*^9, 3.8793544492554092`*^9}, {3.879684541353798*^9, 
   3.879684541740168*^9}, {3.880402138841156*^9, 3.8804023119709044`*^9}, {
   3.88040235408082*^9, 3.880402459967163*^9}, {3.880402501970334*^9, 
   3.8804025710912647`*^9}, {3.880402724276569*^9, 3.880402725109329*^9}, {
   3.880402782729267*^9, 3.880402972241643*^9}, 3.88047173099942*^9, {
   3.880471904274688*^9, 3.8804719568856916`*^9}, {3.880471989912366*^9, 
   3.880472049899775*^9}, {3.8804720839516163`*^9, 3.880472247423634*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"ffbc07ad-fae4-4d9f-814b-a34ef9f1b826"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Idem, mais reduit", "Subtitle",
 CellChangeTimes->{{3.880562014759264*^9, 
  3.880562023143539*^9}},ExpressionUUID->"450b5fc4-7f1e-4339-964b-\
11d3205bcd5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"featureEncoder", "[", "features_", "]"}], ":=", 
  RowBox[{"NetInsertSharedArrays", "[", 
   RowBox[{
    RowBox[{"NetGraph", "@", 
     RowBox[{"FunctionLayer", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "conv1", ",", "conv2", ",", "conv3", ",", "conv4", ",", "conv5", 
           ",", " ", "residual"}], "}"}], ",", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"conv1", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "#Input", "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"conv2", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv1", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"conv3", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "conv2", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"residual", "=", 
            RowBox[{"conv1", "+", "conv3"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"conv4", "=", 
            RowBox[{
             RowBox[{"conv2d", "[", "features", "]"}], "[", "residual", 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"No", " ", "relu"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"conv5", " ", "=", 
            RowBox[{
             RowBox[{"ConvolutionLayer", "[", 
              RowBox[{"features", ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "3"}], "}"}], ",", 
               RowBox[{"PaddingSize", "->", "1"}]}], "]"}], "[", "conv4", 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{"\"\<Output\>\"", "->", "conv5"}], "|>"}]}], 
          "\[IndentingNewLine]", ")"}]}], "]"}], "&"}], "]"}]}], ",", 
    "\"\<featureNet\>\""}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.879341604102272*^9, 3.879341606923513*^9}, {
   3.8793416482042837`*^9, 3.8793417309464006`*^9}, {3.87934179688118*^9, 
   3.8793419019192047`*^9}, {3.879341963951344*^9, 3.879342312163074*^9}, {
   3.879342344437942*^9, 3.879342352231041*^9}, {3.879342419384132*^9, 
   3.87934253958526*^9}, {3.879342599153838*^9, 3.879342607487556*^9}, {
   3.879342854263424*^9, 3.879342945538087*^9}, {3.879343400089707*^9, 
   3.879343468337978*^9}, {3.879343501156274*^9, 3.879343602283358*^9}, {
   3.8793489668687067`*^9, 3.879348967085766*^9}, {3.8793526189412317`*^9, 
   3.87935263388126*^9}, 3.879352891507119*^9, {3.879684605617556*^9, 
   3.8796846115942793`*^9}, {3.879696664922615*^9, 3.8796966649886017`*^9}, {
   3.8803986922123013`*^9, 3.8803987040251493`*^9}, 3.8803992041006193`*^9, {
   3.880399373242453*^9, 3.880399400616716*^9}, {3.880399435793213*^9, 
   3.8803995060658493`*^9}, {3.880399566247752*^9, 3.8803996182884693`*^9}, {
   3.880399653614341*^9, 3.880399655201597*^9}, {3.8803999440968924`*^9, 
   3.88039995765034*^9}, {3.88039999147721*^9, 3.880399995377173*^9}, {
   3.880400166054975*^9, 3.880400195651675*^9}, {3.8804003245220747`*^9, 
   3.880400336993403*^9}, {3.880400443291854*^9, 3.880400469014565*^9}, {
   3.880400567639038*^9, 3.880400569941486*^9}, {3.880408485344247*^9, 
   3.880408493556411*^9}, {3.880408570266678*^9, 3.8804087845421963`*^9}, {
   3.8804090940485907`*^9, 3.880409095074349*^9}, 3.880409181505241*^9, 
   3.8804092222790003`*^9, {3.880444442741788*^9, 3.8804444476792517`*^9}, 
   3.8804445526632957`*^9, {3.880446053404434*^9, 3.880446055508847*^9}, {
   3.880446101508526*^9, 3.8804461016053047`*^9}, {3.880475416974474*^9, 
   3.880475449978484*^9}, 3.880475549739954*^9, {3.880478742346191*^9, 
   3.8804787469893723`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"9a733de8-d203-426b-9a36-56e96d1ed718"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stereoMatcher", "[", "features_", "]"}], ":=", 
  RowBox[{"NetGraph", "@", 
   RowBox[{"FunctionLayer", "[", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "conv19", ",", "conv20", ",", "conv21", ",", "conv22", ",", "conv23", 
         ",", "conv24", ",", "residual", ",", " ", "out"}], "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"conv19", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "#Input", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv20", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "conv19", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv21", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv20", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"conv22", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "4"}], "]"}], "[", "conv21", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"conv23", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", 
            RowBox[{"features", "*", "2"}], "]"}], "[", "conv22", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"residual", "=", 
          RowBox[{"conv21", "+", "conv23"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"conv24", "=", 
          RowBox[{
           RowBox[{"conv3d", "[", "features", "]"}], "[", "residual", "]"}]}],
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "Transposed", " ", "convolutions", "\[IndentingNewLine]", 
             "conv33"}], "=", 
            RowBox[{
             RowBox[{"upconv3d", "[", 
              RowBox[{"features", "*", "2"}], "]"}], "[", "conv20", "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv34", "=", 
            RowBox[{
             RowBox[{"upconv3d", "[", 
              RowBox[{"features", "*", "2"}], "]"}], "[", "conv21", "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv35", "=", 
            RowBox[{
             RowBox[{"upconv3d", "[", 
              RowBox[{"features", "*", "2"}], "]"}], "[", "conv19", "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv36", "=", 
            RowBox[{
             RowBox[{"upconv3d", "[", "features", "]"}], "[", "conv20", 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"conv37", "=", 
            RowBox[{
             RowBox[{"conv3d", "[", "features", "]"}], "[", "conv21", "]"}]}],
            ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"out", "=", 
          RowBox[{
           RowBox[{"NetDelete", "[", 
            RowBox[{
             RowBox[{"conv3d", "[", "1", "]"}], ",", "\"\<3\>\""}], "]"}], 
           "[", "conv24", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"<|", 
          RowBox[{"\"\<Output\>\"", "->", "out"}], "|>"}]}], 
        "\[IndentingNewLine]", ")"}]}], "]"}], "&"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.879353140520178*^9, 3.879353224026003*^9}, {
   3.879354431508976*^9, 3.8793544492554092`*^9}, {3.879684541353798*^9, 
   3.879684541740168*^9}, {3.880402138841156*^9, 3.8804023119709044`*^9}, {
   3.88040235408082*^9, 3.880402459967163*^9}, {3.880402501970334*^9, 
   3.8804025710912647`*^9}, {3.880402724276569*^9, 3.880402725109329*^9}, {
   3.880402782729267*^9, 3.880402972241643*^9}, 3.88047173099942*^9, {
   3.880471904274688*^9, 3.8804719568856916`*^9}, {3.880471989912366*^9, 
   3.880472049899775*^9}, {3.8804720839516163`*^9, 3.880472247423634*^9}, {
   3.880475134969885*^9, 3.880475159882951*^9}, {3.880475205499805*^9, 
   3.880475215656822*^9}, {3.8804753515916147`*^9, 3.8804753878061113`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"c7735b75-1274-46dd-a72b-a543d18b9666"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 789},
WindowMargins->{{71, Automatic}, {Automatic, 180}},
FrontEndVersion->"13.1 pour Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"133cdee4-f324-461e-95ce-e13b71c835b6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 215, 4, 98, "Title",ExpressionUUID->"e37f6926-aed1-48b8-9893-6fbdcfd3ab58"],
Cell[798, 28, 297, 7, 35, "Text",ExpressionUUID->"652cfa43-8369-47ed-b30c-5d606b74c211"],
Cell[1098, 37, 5397, 149, 404, "Input",ExpressionUUID->"cb752701-4dd3-4b12-82d2-b28f89840ba2",
 InitializationCell->True],
Cell[6498, 188, 4976, 128, 425, "Input",ExpressionUUID->"efa95fbf-53d4-4a04-950f-ce5afc42869a",
 InitializationCell->True],
Cell[11477, 318, 15021, 257, 656, "Input",ExpressionUUID->"30f2f15c-5be3-4200-a6c8-000ce99d9aa3",
 InitializationCell->True],
Cell[26501, 577, 639, 13, 46, "Input",ExpressionUUID->"8e2d27ca-11bb-4c92-9c1d-88b5502b96ad",
 InitializationCell->True],
Cell[27143, 592, 368, 6, 46, "Input",ExpressionUUID->"7b7e33a1-1ef0-4d51-8094-2418b4a002a7",
 InitializationCell->True],
Cell[27514, 600, 55331, 765, 278, "Input",ExpressionUUID->"225c6829-52e8-4c58-bc8b-9bb1dc88e975",
 InitializationCell->True],
Cell[82848, 1367, 228, 5, 35, "Text",ExpressionUUID->"3493686d-47b8-4d61-b118-859e8bd2a1e5"],
Cell[CellGroupData[{
Cell[83101, 1376, 158, 3, 53, "Subtitle",ExpressionUUID->"42ec54e8-aa26-444b-9ea9-11cc94b75cba"],
Cell[83262, 1381, 1979, 42, 215, "Input",ExpressionUUID->"686ce73a-0be0-4ccc-a0c2-0fd0f31839d2",
 InitializationCell->True],
Cell[85244, 1425, 1717, 43, 215, "Input",ExpressionUUID->"8f61821c-5e26-4652-a808-7ea1855b6ec2",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[86998, 1473, 173, 3, 53, "Subtitle",ExpressionUUID->"6be80f84-829b-479e-996f-3fd8ba935e3a"],
Cell[87174, 1478, 2253, 47, 236, "Input",ExpressionUUID->"63e85c5e-e28e-4d5d-919e-e44f51076aaf",
 InitializationCell->True],
Cell[89430, 1527, 1739, 43, 215, "Input",ExpressionUUID->"fd96fc62-37b5-4da4-83fa-4b99f4591af0",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[91206, 1575, 191, 3, 53, "Subtitle",ExpressionUUID->"f04ff4ba-dca3-4cd8-9c22-547da685cbe0"],
Cell[91400, 1580, 6444, 134, 698, "Input",ExpressionUUID->"ae5549d3-33af-4aa2-b7dd-0846601c7bc9",
 InitializationCell->True],
Cell[97847, 1716, 1739, 43, 215, "Input",ExpressionUUID->"45e857f8-01c2-44dc-b298-9b3bcaa64f7c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[99623, 1764, 178, 3, 53, "Subtitle",ExpressionUUID->"4fee181d-bfb0-45ea-b9f2-c0e8a88665d0"],
Cell[99804, 1769, 7686, 152, 992, "Input",ExpressionUUID->"261c881e-4cf8-4273-a01b-5c77e106e77e",
 InitializationCell->True],
Cell[107493, 1923, 6895, 153, 1160, "Input",ExpressionUUID->"78502e2f-5670-4d41-b355-3c66eb4e499a",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[114425, 2081, 162, 3, 53, "Subtitle",ExpressionUUID->"f870e77a-1c43-4eea-982e-c0953ff3ec10"],
Cell[114590, 2086, 3717, 71, 320, "Input",ExpressionUUID->"f2197a3c-fb31-47f4-bcec-9e1afc2f0a22",
 InitializationCell->True],
Cell[118310, 2159, 2606, 59, 341, "Input",ExpressionUUID->"c7a7411d-f334-4041-b18f-cc63bbf863c6",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[120953, 2223, 191, 3, 53, "Subtitle",ExpressionUUID->"4ad34e00-98c2-4803-bcde-dafe798beb36"],
Cell[121147, 2228, 7686, 152, 992, "Input",ExpressionUUID->"102b21d0-aa13-4fc1-961d-722a228d02af",
 InitializationCell->True],
Cell[128836, 2382, 8076, 175, 1328, "Input",ExpressionUUID->"ffbc07ad-fae4-4d9f-814b-a34ef9f1b826",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[136949, 2562, 163, 3, 53, "Subtitle",ExpressionUUID->"450b5fc4-7f1e-4339-964b-11d3205bcd5d"],
Cell[137115, 2567, 3975, 75, 341, "Input",ExpressionUUID->"9a733de8-d203-426b-9a36-56e96d1ed718",
 InitializationCell->True],
Cell[141093, 2644, 4354, 93, 677, "Input",ExpressionUUID->"c7735b75-1274-46dd-a72b-a543d18b9666",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}
]
*)

